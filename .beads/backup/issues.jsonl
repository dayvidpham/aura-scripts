{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T10:22:51Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"4e2a75eee6489ccd7e9903ea08714ff09243447316b41ac74806e7a38547dc54","created_at":"2026-02-20T10:13:46Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"---\nreferences:\n  impl_plan: aura-scripts-xky\n  urd: aura-scripts-9d9\n  proposal: aura-scripts-5eh\n  request: aura-scripts-82j\n---\n## Axis C: Elegance and complexity matching\n\nReview all 40 changed files for organization and proportional complexity.\n\nKey questions:\n- Is information well-organized across files (minimal duplication)?\n- Are cross-references between docs correct and navigable?\n- Is the protocol/README.md a good entry point?\n- Does protocol/AGENTS.md avoid duplicating PROCESS.md content?\n- Does protocol/SKILLS.md accurately map commands to phases?\n- Is complexity proportional (not over-documented or under-documented)?\n- Are naming conventions consistent and memorable?\n\n## Files to Review\n40 files: git diff --name-only main...HEAD\n\n## Vote\nBinary: ACCEPT or REVISE","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-0g8","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"IMPL-REVIEW-C-1: Code review (Reviewer C: Elegance)","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"b7322c0a7f0ccf8ef71db9e0e2bdd33d391e7ba1ae46838c3ec1d9a1655312e1","created_at":"2026-02-20T13:53:53Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"Convert aura-scripts from ~/.claude/commands/ layout to a proper plugin with skills/*/SKILL.md format. Own marketplace repo at dayvidpham/aura-scripts.\n\nKey decisions:\n- All commands become skills (skills/\u003cname\u003e/SKILL.md)\n- Protocol docs bundled in skills/protocol/ as supporting files\n- Scripts (aura-swarm, aura-parallel) on PATH, referenced by bare name\n- No plugin agents (roles are skills only)\n- Dual-platform: Claude Code (.claude-plugin/) + OpenCode (native .claude/skills/ discovery)\n- Colon names become hyphens (aura:user:request → user-request, invoked as /aura:user-request)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-0kh","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"open","target":"","timeout_ns":0,"title":"EPIC: Package aura-scripts as Claude Code / OpenCode plugin","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"worker-slice-4","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T09:00:40Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"d0b59d3a6cd251507911dc0a929a4a17702cefa71f8352f07bf05f67e6b53801","created_at":"2026-02-20T08:15:14Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"## References\n- IMPL_PLAN: aura-scripts-xky\n- PROPOSAL-2: aura-scripts-5eh\n- URD: aura-scripts-9d9\n\n## Blocked by SLICE-1 (protocol core must be done first)\n\n## Files (12)\n- commands/aura:supervisor.md (FULL — follow-up epic owner)\n- commands/aura:supervisor:plan-tasks.md (MODERATE)\n- commands/aura:supervisor:track-progress.md (MODERATE)\n- commands/aura:supervisor:spawn-worker.md (MODERATE — handoff template)\n- commands/aura:supervisor:commit.md (MINIMAL)\n- commands/aura:impl:review.md (FULL — severity tree + handoff)\n- commands/aura:impl:slice.md (MODERATE)\n- commands/aura:worker.md (MODERATE)\n- commands/aura:worker:implement.md (MODERATE)\n- commands/aura:worker:complete.md (MODERATE — handoff template)\n- commands/aura:worker:blocked.md (MINIMAL)\n- commands/aura:user:uat.md (MODERATE)\n\n## Key Changes\n1. Supervisor owns EPIC_FOLLOWUP creation (trigger: review completion + IMPORTANT/MINOR exist)\n2. impl:review.md: eager severity tree, SLICE-N-REVIEW naming, handoff\n3. Handoff templates in spawn-worker.md and worker:complete.md\n4. SLICE-N naming in plan-tasks.md\n5. New labels throughout\n6. Replace bd dep relate with frontmatter references\n\n## Quality Gates\n- grep these 12 files for old labels → 0 hits\n- grep for bd dep relate → 0 hits\n- grep for positional bd dep add → 0 hits","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-0m8","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"SLICE-4: Phase 8-12 skills (supervisor + worker + impl)","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T10:14:45Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"11bb7f1c1908eb94d07302b9dd2270154de5e16448850e5826ccca6bb4cd6f81","created_at":"2026-02-20T03:08:43Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"Vote: ACCEPT\n\nIMPORTANT findings:\n1. Old vote/severity tables in CONSTRAINTS.md conflict with new BLOCKER/IMPORTANT/MINOR taxonomy\n2. No skill file defines who creates EPIC_FOLLOWUP\n3. {epic-id} in handoff path is ambiguous\n\nMINOR findings:\n4. Add old-to-new phase mapping table in migration doc\n5. BDD missing empty severity group edge case\n6. aura:plan.md listed but no checklist item\n7. aura:reviewer:review-code.md has deprecated RFC content","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-0xu","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"PROPOSAL-1-REVIEW-A-1: Plan review (Reviewer A: Correctness)","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"a172a5c4b590e91b6389a49d18c0a6524902248402c1517f4f41f17cf6bf56c2","created_at":"2026-02-20T22:56:35Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"VOTE: REVISE — BDD acceptance criteria describe the right integration behaviors, but MVP scope and validation checklist use ambiguous language that could lead to brittle unit tests. Missing: explicit test strategy (subprocess invocation, mocking policy, shared fixtures). See comment on aura-id1 for full reasoning and 4 actionable changes.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-10u","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"open","target":"","timeout_ns":0,"title":"PROPOSAL-1-REVIEW-B-1: Schema-driven context hooks — test quality","updated_at":"2026-02-20T22:56:35Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"c059a412d5a6a41207b73597fd435bc9b2b5afc3a0980113ac078c4799975ad2","created_at":"2026-02-20T10:22:41Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"---\nreferences:\n  request: aura-scripts-82j\n  impl_plan: aura-scripts-xky\n  review_A: aura-scripts-hl2\n  review_B: aura-scripts-du8\n  review_C: aura-scripts-0g8\n---\n## IMPORTANT Findings\n\n### I-A1 (Reviewer A): UAT_EXAMPLE.md not updated to v2\n- protocol/UAT_EXAMPLE.md still uses old labels (aura:user:uat, aura:plan:ratify) and bd dep relate\n- Pre-existing file, not in scope of this epic's 40 changed files\n- Should be updated to v2 labels and frontmatter references\n\n### I-B1 (Reviewer B): aura:test.md uses npm commands\n- commands/aura:test.md uses npm-specific commands (npm run typecheck, npm run test:unit)\n- Should be language-agnostic or use Go examples to match rest of protocol\n\n### I-B2 (Reviewer B): Go test patterns incomplete\n- No mention of table-driven tests (t.Run with subtests), t.Parallel(), t.Helper()\n- Acceptable for language-agnostic MVP but worth adding\n\n### I-B3 (Reviewer B): L2 failure semantics\n- \"Tests will FAIL\" at L2 is misleading for compiled languages like Go\n- Importing a non-existent function causes compilation error, not test failure\n- Add clarifying note about build errors vs test failures\n\n### I-C1 (Reviewer C): PROCESS.md link paths inconsistent\n- 30 of 33 command files use bare (PROCESS.md#...) links\n- 3 files correctly use (../../protocol/PROCESS.md#...)\n- Should standardize to one convention\n\n### I-C2 (Reviewer C): UAT_EXAMPLE.md not updated (same as I-A1)\n- Duplicate of I-A1, confirms the finding\n\n## MINOR Findings\n\n### M-A1: aura:test.md npm commands (same as I-B1)\n### M-A2: user-request-revamp-v2.md retains old labels (historical, no action needed)\n### M-A3: PROPOSAL-2 source text has bd dep relate (implemented docs correct, source is historical)\n### M-B4: Fixture/constant rules not cross-referenced from worker.md or test.md\n### M-C1: Handoff transition table duplicated across 4 files\n### M-C2: Full label schema repeated in 5 files\n### M-C3: aura:test.md npm commands (same as I-B1)\n### M-C4: PROCESS.md section anchors may not match rendered anchor names\n### M-C5: aura:p9-impl:slice-complete label used but not in official label schema","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-1vo","is_template":0,"issue_type":"epic","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"open","target":"","timeout_ns":0,"title":"FOLLOWUP: Non-blocking improvements from code review (aura-scripts-xky)","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"30f286e041c9c250ac014b9eee9d693b90e98ff3bcfa2ce50dd442431ee77d74","created_at":"2026-02-20T22:05:48Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"---\nclassification:\n  scope: cross-cutting\n  complexity: medium\n  risk: new-api\n  novelty: familiar\n  research_depth: standard-research\n---\n## Verbatim User Request\n\nMost skills do not reference the PROCESS.md or CLAUDE.md. It is costly to copy a fragment many times, and hard to maintain as drift becomes a real issue. We need the @skills/protocol/CLAUDE.md to be referenced everywhere, and the @skills/protocol/PROCESS.md to be referenced by the architect, supervisor, and reviewers. Workers do not need to reference the process. Let's make a Python hook we will use to manage repeated context fragments. We also need to keep the @skills/protocol/schema.xml up to date. The @skills/protocol/schema.xml should tell us what should reference what, and at what stage. The Python script can take an argument (role, phase, step), ingest the schema and then tell the agent where to look and what skills to run.\n\n## Problem Statement\n\n1. Only 5/39 skills reference CLAUDE.md (should be everywhere)\n2. 31/39 reference PROCESS.md inconsistently (should be architect/supervisor/reviewer only)\n3. No skills reference schema.xml (schema should be the source of truth for what references what)\n4. Repeated context fragments across skills cause drift and are costly to maintain\n5. Need a Python PreToolUse hook that ingests schema.xml and injects the right context per role/phase/step","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-2o8","is_template":0,"issue_type":"feature","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"open","target":"","timeout_ns":0,"title":"REQUEST: Context fragment management via PreToolUse hook + schema-driven doc references","updated_at":"2026-02-20T22:05:48Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"architect","await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"eed7fef9619bab6d038f6e1ad1517deeef1fba2703d91536505b9ff82115a134","created_at":"2026-02-21T19:37:39Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"---\nverbatim_request: \"I need automated release tagging and version bumping for the Claude Code plugin.\"\nclassification:\n  scope: medium\n  complexity: medium\n  risk: low\n  domain_novelty: low\n---\n\n## User Request (Verbatim)\n\n\"I need automated release tagging and version bumping for the Claude Code plugin.\"\n\n## Context\n\nThe aura-plugins repository currently has:\n- 3 version sources: pyproject.toml, .claude-plugin/plugin.json, .claude-plugin/marketplace.json\n- Version sources are already out of sync (marketplace.json at 0.2.1, others at 0.2.2)\n- No git tags exist\n- No automated release scripts\n- No CHANGELOG.md\n- Manual versioning via direct file edits\n- Pure Python tooling pattern (stdlib only, zero external deps) in bin/\n\n## What's Needed\n\nA release automation tool that:\n1. Bumps version consistently across all 3 manifest files\n2. Creates git tags for releases\n3. Validates version consistency before/after\n4. Follows the existing bin/ tool conventions (Python 3.10+, stdlib only)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-334","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"open","target":"","timeout_ns":0,"title":"REQUEST: Automated release tagging and version bumping for aura-plugins","updated_at":"2026-02-21T19:37:39Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-18T14:09:11Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"391e1f4824442968c399f5252d6ff5aea706cdb9a69368d04f987d38b6e523da","created_at":"2026-02-18T13:56:15Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-35o","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"REVIEW_2: Plan review for aura-scripts Nix flake","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T10:22:52Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"8dc01e1b086c908384bf355d5e9e196b11ec0d978402f58809e38d328ddcbddf","created_at":"2026-02-20T10:13:57Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"Minor findings from Reviewer A (Correctness)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-40x","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"IMPL-REVIEW-A-1 MINOR","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"architect","await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"3ebd6800107b15166e821a5360ce04c08e514c11391ba5b632808635de9287d7","created_at":"2026-02-20T03:02:59Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"## URE Survey — Full Verbatim Q\u0026A Record\n\nRequest task: aura-scripts-82j\n\n---\n\n### Component 1: Label Format \u0026 Enforcement\n\n**Q1a: What label format should Aura use for structured task taxonomy?**\n\nOptions presented:\n- (1) Hierarchical with phase number: `aura:p{N}-{phase}:s{M}-{type}` — Machine-parseable, encodes phase + step. Example: `aura:p3-plan:s1-propose`\n- (2) Flat descriptive: `aura:plan:propose`, `aura:impl:slice-1` — Human-readable, no phase numbers. Relies on convention.\n- (3) Domain:action:target: `aura:review:proposal-1`, `aura:impl:slice:auth-module` — Most readable but hardest to validate programmatically.\n- (4) Numeric-only prefix: `aura:3.1:propose`, `aura:9.2:slice` — Most compact but least self-documenting.\n\n**User response (verbatim):** \"Similar to (1): aura:p{phase-number}-{phase}:s{step-number}-{type}. phase-number refers to which phase in the overall process, and step-number exists because each phase usually has an enumerated workflow, some order of operations. This would look like aura:p2-user:s2-elicit (s1 is 1_1-classify, 1_2-research). 1_1 is classifying the user request along some taxonomy (similar to the https://github.com/jonathanung/finesse planner plugin.) 1_2-research is similar to the research step at https://github.com/gsd-build/get-shit-done/, finding what standards exist in this domain, and if a new feature proposal or entire application proposal---trying to find out what other well-regarded projects have been created to address similar issues. Then 1_3-explore is codebase exploration, to see what is currently implemented. Happens in parallel with 1_2-research.\"\n\n**Q1b: How should labels be enforced?**\n\nOptions presented:\n- (1) Required + validated: Every bd create must include a label matching the schema. A validation step checks after creation.\n- (2) Required + auto-applied: Skills auto-apply labels in their bd create templates. No manual labeling needed.\n- (3) Optional but audited: Labels are recommended. A periodic audit flags unlabeled tasks.\n- (4) Schema-only (documentation): Labels are documented but not enforced. Agents self-apply.\n\n**User response (verbatim):** \"(1) and (2). You can now continue with the user's answers in mind.\"\n\n---\n\n### Component 2: Classification, Research, Phase 2 Shape\n\n**Q2a: For the s1_1-classify step, which classification axes should be used?**\n\nOptions presented:\n- By scope: single-file fix, multi-file feature, cross-cutting refactor, new subsystem\n- By complexity: trivial, moderate, complex, research-required\n- By risk: low (internal only), medium (affects existing behavior), high (breaking changes), critical (security/data)\n- By domain novelty: known pattern, adaptation of known, novel design required, research-first\n\n**User response (verbatim):** \"By scope, By complexity, By risk, By domain novelty\" (selected all four)\n\n**Q2b: For s1_2-research, how deep should research go?**\n\nOptions presented:\n- Always web + local: Every request gets both codebase exploration and web research for prior art. Thorough but slow.\n- Local only by default: Codebase exploration always happens. Web research only when classify step flags \"novel\" or \"research-required\".\n- Configurable per-request: Classify step determines depth. User confirms before web research. Most flexible.\n- Skip for known patterns: If classify says \"known pattern\", skip research entirely. Only research for novel/complex.\n\n**User response (verbatim):** \"Configurable per-request. Determine depth required from classify step, then ask user if it matches their expectations. Local is generally always allowed and some degree of local exploration and research is going to happen. Web for deeper research requirements. A good example of this flow is at the @protocol/RESEARCH_EXAMPLE-nix-openclaw-req-ure-proposal.md file, but this repo has incorrect backwards direction dependencies, so ignore those.\"\n\n**Q2c: Phase 2 currently creates an ELICIT task then separately a URD. Should they merge?**\n\nOptions presented:\n- Keep separate (URD as Phase 2.5): ELICIT captures Q\u0026A, URD is created after as a separate synthesis step. Clear separation of raw data vs. requirements.\n- Merge URD into Phase 2: ELICIT step creates the URD directly as s2_2. URD is the structured output of elicitation. Fewer tasks.\n- URD replaces ELICIT: No separate ELICIT task. The URD IS the elicitation record. Simplest but loses raw Q\u0026A.\n- ELICIT is a comment on URD: URD is the primary task. The raw Q\u0026A is stored as a comment. One task, full history.\n\n**User response (verbatim):** \"Merge URD into Phase 2\"\n\n---\n\n### Component 3: Dependency Tree \u0026 Naming Conventions\n\n**Q3a: How should superseded proposals be marked?**\n\nOptions presented:\n- Label: aura:superseded — Add a label to the old proposal. Simple, queryable via `bd list --label aura:superseded`\n- Comment with link — Add comment to old proposal: 'SUPERSEDED by PROPOSAL-2 (task-id)'. Preserves audit trail.\n- Both label + comment — Label for querying, comment for context. Belt and suspenders.\n- Status field only — Use bd's native status/close mechanism if available, no custom label needed\n\n**User response (verbatim):** \"Both label + comment, Label: aura:superseded, Comment with link\"\n\n**Q3b: For task title naming, should the N in PROPOSAL-N and M in REVIEW-M be prefix, suffix, or request-ID prefix?**\n\nOptions presented:\n- Prefix with N (Option A): PROPOSAL-N as title prefix. Clear, grep-able, sequencing visible at a glance.\n- Suffix with rev/round (Option B): More readable titles, sequencing in parenthetical. Harder to grep consistently.\n- Request-ID prefix (Option C): Includes parent request ID for cross-referencing across epochs. Longest but most traceable.\n- Labels carry sequence, titles stay clean: Title is just descriptive text, all sequencing lives in labels.\n\n**User response (verbatim):** \"Prefix with N (Option A)\"\n\n**Q3c: Should code review tasks block the slice or IMPL_PLAN directly?**\n\nOptions presented:\n- Reviews block slice (Option A): Natural: slice can't close until its reviews pass. Keeps review context grouped with the work they review.\n- Reviews block IMPL_PLAN (Option B): Flatter tree. IMPL_PLAN directly sees all outstanding reviews. But loses the slice-review grouping.\n- Reviews block a REVIEW-ROUND parent: Add a REVIEW-ROUND-N task that groups all 3 reviewers. Extra layer but clean grouping.\n\n**User response (verbatim):** \"Okay. I got it. The following schema and process will allow the original REQUEST and IMPL_PLAN epics to close once their implementation is complete, and the blocking issues produced by the reviewers are fixed. This will also allow the reviews to not get lost, and it produces a structured schema for the reviews to live inside a follow up epic. This schema should map cleanly into a sensible database design. As part of your output, include what that database design would look like and request feedback on it.\n\n## The original EPIC\n\nFor each slice, a review round produces a SLICE-1-REVIEW-{A,B,C,...}-{1,2,...} tracking issue. This tracking issue in turn creates children tracking issues, grouped uniquely by severity. The leaf tasks produced by the review will have two parents: one being the review severity tracker, and the other, explained in the next section, will be the vertical slices created afterwards during the EPIC_FOLLOWUP_IMPL_PLAN.\n\nThis REVIEW-{A,B,C,...}-{1,2,...} tracking issue will have several children tracking issues, grouped by {BLOCKER,IMPORTANT,MINOR} severity. These children can also be empty and have no children if no review leaf tasks are produced at that severity. In that case, the severity tracking issue should be closed.\n\nSLICE-1-REVIEW-{A,B,C,...}-{1,2,...}\n  ├── blocked by SLICE-1-REVIEW-{A,B,C,...}-{1,2,...}-BLOCKER\n  ├      ├── blocked by review-blocker-leaf-task-1\n  ├      ├── blocked by review-blocker-leaf-task-...\n  ├      └── blocked by review-blocker-leaf-task-{k}\n  ├── blocked by SLICE-1-REVIEW-{A,B,C,...}-{1,2,...}-IMPORTANT\n  ├     ├── blocked by review-important-leaf-task-1\n  ├     ├── blocked by review-important-leaf-task-...\n  ├     └── blocked by review-important-leaf-task-{k}\n  └── blocked by SLICE-1-REVIEW-{A,B,C,...}-{1,2,...}-MINOR\n        ├── blocked by review-minor-leaf-task-1\n        ├── blocked by review-minor-leaf-task-...\n        └── blocked by review-minor-leaf-task-{k}\n\nThe child blocker tracking issue will ALSO be a child of the slice it belongs to, so it has two parents:\n\nSLICE-1\n  ├── blocked by leaf-task-1\n  ├── blocked by leaf-task-2\n  └── blocked by SLICE-1-REVIEW-{A,B,C,...}-{1,2,...}-BLOCKERS\n        ├── blocked by review-blocker-leaf-task-1\n        ├── blocked by review-blocker-leaf-task-...\n        └── blocked by review-blocker-leaf-task-{k}\n\n## The EPIC_FOLLOWUP\n\nAnd a new followup epic tracking issue would be created. When the EPIC_FOLLOWUP_IMPL_PLAN is sliced up by a supervisor, the review leaf tasks will gain a new parent: the vertical slices for the followup implementation.\n\nEPIC_FOLLOWUP:\n  ├── URD (from the parent REQUEST epic)\n  ├── REVIEW-A-{1,2,...} (reviews on the slices from the original IMPL_PLAN)\n  ├── REVIEW-B-{1,2,...}\n  ├── REVIEW-C-{1,2,...}\n  ├── FOLLOWUP_URE (new URE phase to determine the scope of the followup that should be handled)\n      ├── FOLLOWUP_URD (new tracking URD to document requirements for the followup work)\n      ├── FOLLOWUP_PROPOSAL (taking into account the totality of the outstanding follow-up work, the original URD, and the new FOLLOWUP_URD)\n          ├── EPIC_FOLLOWUP_IMPL_PLAN:\n              ├── blocked by FOLLOWUP-SLICE-1\n              ├    ├── blocked by review-important-leaf-task-...\n              ├    └── blocked by review-minor-leaf-task-{k} (assorted leftover IMPORTANT,MINOR tasks belonging to the independent followup slice)\n              ├── blocked by FOLLOWUP-SLICE-2\n                   ├── blocked by review-important-leaf-task-...\n                   └── blocked by review-minor-leaf-task-{k} (assorted leftover IMPORTANT,MINOR tasks belonging to the independent followup slice)\"\n\n---\n\n### Component 4: Database Design\n\n**Q4a: Does the database design correctly capture the dual-parent relationship and follow-up epic migration?**\n\nOptions presented:\n- Correct as shown: The tables, constraints, and dual-parent pattern match the intended schema.\n- Separate severity from kind: severity should be an independent dimension, not coupled to kind. Any task type could potentially have a severity.\n- Add epic_ref as FK chain: epic_ref should be a chain (FOLLOWUP_SLICE → FOLLOWUP_IMPL_PLAN → EPIC_FOLLOWUP → original EPIC) rather than a flat reference to the top-level epic.\n- Missing fields/tables: Need additional columns (e.g., assignee, reviewer_id, round_number) or tables (e.g., review_rounds, epics)\n\n**User response (verbatim):** \"Separate severity from kind, Correct as shown, Missing fields/tables\"\n**User notes (verbatim):** \"During your thoughts, you say 'a review leaf task could be blocked by both a severity tracker and a follow-up slice—and each task needs a type field to distinguish between all these different task categories.' But this is incorrect, the directions are reversed. The review leaf task is the LEAF. it is not blocked by anything. it is the blocker for its two parents\"\n\n**Q4b: Should FOLLOWUP variants be separate enum values, boolean flag, or generation counter?**\n\nOptions presented:\n- Separate enum values (A): Simple, explicit, no ambiguity. But enum grows if followup-of-followup happens.\n- Boolean flag (B): Keeps kind enum small, followup is orthogonal. But only handles one level of followup.\n- Generation counter (C): Handles arbitrary depth of followup chains. Most flexible but adds complexity.\n- Derive from epic_ref: Don't store followup status on the task. Infer it by walking epic_ref chain.\n\n**User response (verbatim):** \"(A) Separate enum values. Don't need to add followup-of-followup enum: simple single parent relationship.\"\n\n---\n\n### Component 5: Handoff Documents\n\n**Q5a: Should handoff templates be at every transition or only critical ones?**\n\nOptions presented:\n- All phase transitions: Every transition gets a structured handoff document. Maximum context preservation but high overhead.\n- Architect+Supervisor and Reviewer+Followup only: The two transitions where the most context is lost.\n- Architect-to-Supervisor only: This is the critical handoff. Everything else flows through beads tasks.\n- Configurable per-epic: The classify step determines how many handoff documents are needed.\n\n**User response (verbatim):** \"All phase transitions\"\n**User notes (verbatim):** \"There is a Supervisor to Reviewer handoff too. Would WOULD need to put the standardized handoff template in each skill though.\"\n\n**Q5b: Where should handoff documents be stored?**\n\nOptions presented:\n- Markdown file in repo: Git-tracked, reviewable in PRs, survives beads DB issues. But adds file bloat.\n- Beads task description: Queryable via bd, lives with the task it describes. But limited by description field size.\n- Beads task + file reference: Create a Beads task that references a markdown file path. Best of both.\n- Just the Beads task description: Keep it simple.\n\n**User response (verbatim):** \"Can put the handoff docs in the repo's .git/.aura/handoff/{something}.md . Should not actually be pushed up to the git repo unless the user decides they manually want to do that.\"\n\n**Q5c: Should handoff docs include full provenance or summary + IDs?**\n\nOptions presented:\n- Full provenance inline: Self-contained: new agent can understand everything without bd lookups.\n- Summary + beads IDs: Lean: 1-paragraph summary of each phase, with bd IDs for deep-dive.\n- Depends on transition type: Architect-to-Supervisor gets full provenance. Worker-to-Reviewer gets summary + IDs.\n\n**User response (verbatim):** \"Depends on transition type\"\n\n---\n\n### Component 6: Validation Pipeline\n\n**Q6a: How should validation rules be defined and enforced?**\n\nOptions presented:\n- Shell wrapper around bd: A bd-validate or bd-check command that shells out to bd and validates.\n- Beads hook/plugin: If beads supports hooks, register validation that runs automatically.\n- YAML/TOML config + validation command: Define rules declaratively in a config file.\n- Given/When/Then constraints only: No automated enforcement. Rules exist as human-readable constraints.\n\n**User response (verbatim):** \"Shell wrapper around bd, YAML/TOML config + validation command\"\n**User notes (verbatim):** \"Should be some Python script that can be run as a Claude Code or OpenCode plugin. Define our requirements as an XML schema.\"\n\n**Later correction (verbatim):** \"YAML rules should probably just be XML schema\" and \"YAML rules, strange to have both yaml and XML. should just be XML then.\"\n\n**Q6b: When validation fails, what should happen?**\n\nOptions presented:\n- Hard block: refuse to proceed\n- Warn + require explicit override\n- Warn only (log and continue)\n- Configurable per-rule severity\n\n**User response (verbatim):** \"Hard block: refuse to proceed\"\n\n**Q6c: Should rules query the task graph or only check structural fields?**\n\nOptions presented:\n- Graph-aware rules (query task relationships)\n- Structural rules only (label/title/field checks)\n- Both tiers: structural + graph-aware\n- Start structural, add graph later\n\n**User response (verbatim):** \"Start structural, add graph later\"\n\n---\n\n### Component 7: Process Guardrails\n\n**Q7a: Should there be a periodic audit command for lost work?**\n\nOptions presented:\n- Yes, periodic audit command\n- Built into phase transitions\n- Both: transitions + periodic\n- Not needed yet\n\n**User response (verbatim):** \"Built into phase transitions\"\n\n**Q7b: How should agents be notified of stale/orphaned work?**\n\nOptions presented:\n- Beads comment on parent task\n- Dedicated AUDIT beads task\n- File at .git/.aura/audit/latest.md\n- All of the above, tiered by severity\n\n**User response (verbatim):** \"File at .git/.aura/audit/latest.md\"\n\n**Q7c: Catch-all — anything else not covered?**\n\nOptions presented:\n- Nothing else\n- Agent session management\n- Testing strategy for the protocol itself\n- Migration path from current protocol\n\n**User response (verbatim):** \"Nothing else, Testing strategy for the protocol itself, Migration path from current protocol\"\n**User notes (verbatim):** \"YAML rules should probably just be XML schema\"\n\n---\n\n### Post-survey user feedback (verbatim)\n\"lots of requirements gathered at this point. Strict validations and auditting can be for a v2. Need a thinner MVP v1.\"","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-4ed","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"open","target":"","timeout_ns":0,"title":"ELICIT: Aura protocol architectural redesign","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"worker-slice-1","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T08:47:26Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"1bc6d62b282aac319ebb91083e534b1b98f5288e09b0ee2f6d44e3352b238c82","created_at":"2026-02-20T08:14:53Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"## References\n- IMPL_PLAN: aura-scripts-xky\n- PROPOSAL-2: aura-scripts-5eh\n- URD: aura-scripts-9d9\n\n## Files (6)\n- protocol/CLAUDE.md (FULL)\n- protocol/PROCESS.md (FULL)\n- protocol/CONSTRAINTS.md (FULL)\n- protocol/UAT_TEMPLATE.md (MODERATE)\n- protocol/HANDOFF_TEMPLATE.md (CREATE)\n- protocol/MIGRATION_v1_to_v2.md (CREATE)\n\n## PREREQUISITE: Slices 2-5 depend on this slice.\n\n## Key Changes\n1. New label format aura:p{N}-{domain}:s{M}-{type} throughout\n2. Review severity tree: EAGER creation (always 3 groups), dual-parent BLOCKER\n3. Follow-up epic: trigger = review completion + IMPORTANT/MINOR exist. Owner = Supervisor.\n4. Vocabulary: ACCEPT/REVISE + BLOCKER/IMPORTANT/MINOR\n5. Replace ALL bd dep relate with frontmatter references\n6. Dependency examples use bd dep add \u003cparent\u003e --blocked-by \u003cchild\u003e\n7. Expanded Phase 1 (s1_1-classify, s1_2-research, s1_3-explore)\n8. Handoff template (CREATE) with 5 actor-change transitions\n9. Migration procedure (CREATE) with label + title mapping, additive approach\n10. Reconcile old vote/severity tables in CONSTRAINTS.md\n\n## Quality Gates\n- grep protocol/ for old labels → 0 hits\n- grep protocol/ for BLOCKING, MAJOR, APPROVE_WITH_COMMENTS, REQUEST_CHANGES, REJECT → 0 hits\n- grep protocol/ for 'bd dep relate' → 0 hits\n- grep protocol/ for positional bd dep add (without --blocked-by) → 0 hits","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-4s1","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"SLICE-1: Protocol core + label schema","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T10:14:46Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"64167412d5d35675ea9bbf2a14d825eaa8ad785993ff231d6bd985225e7bfecd","created_at":"2026-02-20T03:08:43Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"Vote: REVISE\n\nBLOCKER findings:\n1. Migration path is a placeholder — needs documented procedure for existing in-flight epics\n2. 12-phase numbering is cognitively heavy — p1-user/p2-user/p5-user/p11-user all say \"user\" but mean different things\n\nIMPORTANT findings:\n3. 25 files with no consistency mechanism — need grep-based verification step\n4. Review severity tree creates ~48+ tasks per implementation — consider lazy severity group creation\n5. Follow-up epic trigger/owner is ambiguous\n6. Handoff at every transition excessive for MVP — some are same-actor\n\nMINOR findings:\n7. Phase mapping table for migration\n8. s1_1 vs s1 step numbering inconsistency\n9. Four slices correct but Slice 1 is prerequisite for 2-4 (not explicit)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-51s","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"PROPOSAL-1-REVIEW-C-1: Plan review (Reviewer C: Elegance)","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"architect","await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"950f8093227caa7498f5af79eba3259dbed98350ed5e25c6066170721a4662b4","created_at":"2026-02-20T03:11:06Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"## Requirements Traceability\n- **URD:** aura-scripts-9d9\n- **ELICIT:** aura-scripts-4ed\n- **REQUEST:** aura-scripts-82j\n- **Supersedes:** PROPOSAL-1 (aura-scripts-9hn)\n\n## Changes from PROPOSAL-1\n\nAddresses 4 BLOCKERs from review round 1:\n\n**B1 (Reviewer B):** Added all 15 missing skill files to Files Affected (33 total skills + 5 protocol + 2 new = 40 files). Each file categorized by change depth: FULL (substantial rewrite), MODERATE (label + convention updates), or MINIMAL (label-only swap).\n\n**B2 (Reviewer B):** Added \"Reviewer Severity Tree Creation\" section with concrete bd dep add command sequences for dual-parent BLOCKER relationship.\n\n**C1 (Reviewer C):** Added \"Migration Procedure\" section with documented steps for in-flight epics, old labels, old titles.\n\n**C2 (Reviewer C):** Justified 12-phase numbering. The step-type suffix (-request, -elicit, -uat) disambiguates repeated domains. Phase numbers exist for ordering/querying, not human memorization. User explicitly chose this format in URE Q1.\n\nAlso addresses IMPORTANT findings:\n- Follow-up epic owner: Supervisor creates EPIC_FOLLOWUP after Phase 10 review completes and all BLOCKERs resolved\n- Empty severity group BDD criterion added\n- All 5 handoff transitions explicitly assigned to skills\n- Old vote/severity vocabulary (APPROVE/REJECT, BLOCKING/MAJOR) reconciled to ACCEPT/REVISE + BLOCKER/IMPORTANT/MINOR\n- Lazy severity group creation: groups only created when findings exist at that severity\n- Grep-based consistency verification step added to each slice\n- Slice 1 is explicit prerequisite for Slices 2-5\n- Plan reviews use ACCEPT/REVISE only, no severity tree (severity tree is code review Phase 10 only)\n\n---\n\n## Problem Space\n\n(Unchanged from PROPOSAL-1)\n\n**Axes:**\n- Parallelism: HIGH — skill files are independent, can be updated in parallel\n- Distribution: Single repo, all files in commands/ and protocol/\n- Scale: 40 files (33 skills + 5 protocol + 2 new)\n- Frequency: One-time migration, then maintained per-epoch\n\n---\n\n## MVP v1 Scope\n\nProtocol and skill file updates ONLY. No runtime tooling.\n\n### In scope:\n1. Label taxonomy in ALL 33 skill files\n2. Expanded Phase 1 sub-steps (classify, research, explore)\n3. URD merged into Phase 2 as s2_2\n4. Task naming (PROPOSAL-N, REVIEW-M)\n5. Review severity tree with dual-parent BLOCKER (code reviews only)\n6. Follow-up epic workflow with explicit trigger/owner\n7. Handoff template for all 5 actor-change transitions\n8. Superseded marking (label + comment)\n9. Migration procedure\n10. Old vocabulary reconciliation (APPROVE/REJECT → ACCEPT/REVISE, BLOCKING/MAJOR → BLOCKER/IMPORTANT)\n\n### Out of scope (v2):\n- Python validation plugin / XML schema enforcement\n- Graph-aware validation rules\n- Automated audit commands\n- Testing strategy for the protocol\n- Database table implementation\n\n---\n\n## Label Schema\n\n\\`\\`\\`\nFormat: aura:p{phase}-{domain}:s{step}-{type}\n\nPhase-domain pairs (12 phases):\n  p1-user    — Request + classify + research + explore\n  p2-user    — Elicit + URD\n  p3-plan    — Propose\n  p4-plan    — Plan review\n  p5-user    — Plan UAT\n  p6-plan    — Ratify\n  p7-plan    — Handoff\n  p8-impl    — Impl plan\n  p9-impl    — Worker slices\n  p10-impl   — Code review\n  p11-user   — Impl UAT\n  p12-impl   — Landing\n\nNote: \"user\" domain repeats at p1/p2/p5/p11 but is always\ndisambiguated by the step-type suffix:\n  p1-user:s1_1-classify  vs  p5-user:s1-uat  vs  p11-user:s1-uat\n\nSub-step notation (s{N}_{M}) is used within Phase 1 and Phase 2\nwhere multiple sub-steps exist. Other phases use simple s{M}.\n\nSpecial labels:\n  aura:urd                  — User Requirements Document\n  aura:superseded           — Superseded proposal/plan\n  aura:severity:blocker     — Blocker severity group\n  aura:severity:important   — Important severity group\n  aura:severity:minor       — Minor severity group\n\\`\\`\\`\n\n---\n\n## Reviewer Severity Tree Creation (NEW — addresses B2)\n\nThis is the concrete operational procedure for code reviewers (Phase 10).\nAssigned to: aura:reviewer:review-code.md and aura:impl:review.md\n\n### Step 1: After review, create severity groups (lazy — only if findings exist)\n\n\\`\\`\\`bash\n# Only create groups that have findings. Skip empty groups entirely.\n# Example: Reviewer A, Round 1 on SLICE-1, has 2 blockers and 1 important, 0 minor\n\n# Create the review round task\nbd create --labels \"aura:p10-impl:s1-review,aura:severity:blocker,aura:severity:important\" \\\n  --title \"SLICE-1-REVIEW-A-1: Code review\" \\\n  --description \"...\" \n# Returns: \u003creview-round-id\u003e\n\n# Create BLOCKER severity group (has findings)\nbd create --labels \"aura:severity:blocker\" \\\n  --title \"SLICE-1-REVIEW-A-1-BLOCKER: Blocker findings\" \\\n  --description \"...\"\n# Returns: \u003cblocker-group-id\u003e\n\n# Create IMPORTANT severity group (has findings)\nbd create --labels \"aura:severity:important\" \\\n  --title \"SLICE-1-REVIEW-A-1-IMPORTANT: Important findings\" \\\n  --description \"...\"\n# Returns: \u003cimportant-group-id\u003e\n\n# NO MINOR group created — reviewer found 0 minor issues\n\\`\\`\\`\n\n### Step 2: Create leaf tasks under severity groups\n\n\\`\\`\\`bash\nbd create --title \"Fix null check in auth handler\" --description \"...\"\n# Returns: \u003cblocker-leaf-1\u003e\n\nbd create --title \"Add input validation on email field\" --description \"...\"\n# Returns: \u003cblocker-leaf-2\u003e\n\nbd create --title \"Rename ambiguous variable\" --description \"...\"\n# Returns: \u003cimportant-leaf-1\u003e\n\\`\\`\\`\n\n### Step 3: Wire dependencies — DUAL-PARENT for BLOCKER group\n\n\\`\\`\\`bash\n# Review round blocked by its severity groups\nbd dep add \u003creview-round-id\u003e --blocked-by \u003cblocker-group-id\u003e\nbd dep add \u003creview-round-id\u003e --blocked-by \u003cimportant-group-id\u003e\n\n# Severity groups blocked by their leaf tasks\nbd dep add \u003cblocker-group-id\u003e --blocked-by \u003cblocker-leaf-1\u003e\nbd dep add \u003cblocker-group-id\u003e --blocked-by \u003cblocker-leaf-2\u003e\nbd dep add \u003cimportant-group-id\u003e --blocked-by \u003cimportant-leaf-1\u003e\n\n# DUAL-PARENT: BLOCKER group ALSO blocks the SLICE\n# This prevents the slice from closing until blockers are resolved\nbd dep add \u003cslice-id\u003e --blocked-by \u003cblocker-group-id\u003e\n\n# IMPORTANT/MINOR groups do NOT block the slice — they go to EPIC_FOLLOWUP\n\\`\\`\\`\n\n### Step 4: Resulting tree\n\n\\`\\`\\`\nSLICE-1 (cannot close until blocker group resolves)\n  ├── blocked by leaf-task-a (impl work)\n  ├── blocked by leaf-task-b (impl work)\n  └── blocked by SLICE-1-REVIEW-A-1-BLOCKER (dual-parent)\n        ├── blocked by blocker-leaf-1\n        └── blocked by blocker-leaf-2\n\nSLICE-1-REVIEW-A-1 (review round)\n  ├── blocked by SLICE-1-REVIEW-A-1-BLOCKER (also blocks slice above)\n  │     ├── blocked by blocker-leaf-1\n  │     └── blocked by blocker-leaf-2\n  └── blocked by SLICE-1-REVIEW-A-1-IMPORTANT (does NOT block slice)\n        └── blocked by important-leaf-1\n\\`\\`\\`\n\n---\n\n## Follow-up Epic Creation (NEW — addresses I3)\n\n**Owner:** Supervisor (aura:supervisor.md)\n**Trigger:** After Phase 10 review completes AND all BLOCKER groups are resolved.\n\n\\`\\`\\`bash\n# Check: any unresolved IMPORTANT/MINOR severity groups?\n# If yes, create EPIC_FOLLOWUP\n\nbd create --labels \"aura:epic-followup\" \\\n  --title \"EPIC_FOLLOWUP: {feature} follow-up\" \\\n  --description \"Follow-up epic for IMPORTANT/MINOR findings from {original-epic-id}\"\n# Returns: \u003cfollowup-id\u003e\n\n# Link to original URD (relates_to, not blocked-by)\nbd dep relate \u003cfollowup-id\u003e \u003curd-id\u003e\n\n# The followup epic then goes through its own phases:\n# FOLLOWUP_URE → FOLLOWUP_URD → FOLLOWUP_PROPOSAL → FOLLOWUP_IMPL_PLAN\n# During FOLLOWUP_IMPL_PLAN slicing, existing IMPORTANT/MINOR leaf tasks\n# gain a new parent (the followup slice):\nbd dep add \u003cfollowup-slice-id\u003e --blocked-by \u003cimportant-leaf-1\u003e\n\\`\\`\\`\n\n---\n\n## Migration Procedure (NEW — addresses C1)\n\n### For in-flight epics (existing beads tasks using old schema):\n\n1. **Old labels are NOT removed.** New labels are ADDED alongside old ones.\n   - Example: a task with `aura:plan:propose` also gets `aura:p3-plan:s1-propose`\n   - This allows old and new skills to coexist during transition\n\n2. **Old title conventions still recognized.** Agents reading tasks check both:\n   - Old: `REQUEST_PLAN:`, `PROPOSE_PLAN:`, `RATIFIED_PLAN:`\n   - New: `REQUEST:`, `PROPOSAL-N:`, `IMPL_PLAN:`\n\n3. **No retroactive restructuring.** Existing dependency trees are not modified.\n   New conventions apply only to newly created tasks.\n\n4. **Transition complete when:** No tasks with ONLY old-format labels remain open.\n   At that point, old label patterns can be documented as deprecated.\n\n### Label mapping table:\n\n\\`\\`\\`\nOld label              → New label\naura:user:request      → aura:p1-user:s1-request\naura:user:elicit       → aura:p2-user:s1-elicit\naura:urd               → aura:urd (unchanged)\naura:propose-plan      → aura:p3-plan:s1-propose\naura:plan:review       → aura:p4-plan:s{M}-review\naura:user:uat          → aura:p5-user:s1-uat (plan) / aura:p11-user:s1-uat (impl)\naura:plan:ratify       → aura:p6-plan:s1-ratify\naura:plan:handoff      → aura:p7-plan:s1-handoff\naura:impl:plan         → aura:p8-impl:s1-plan\naura:impl:slice        → aura:p9-impl:s{M}-slice\naura:impl:review       → aura:p10-impl:s{M}-review\naura:impl:uat          → aura:p11-user:s1-uat\n\\`\\`\\`\n\n### Title mapping:\n\n\\`\\`\\`\nOld title prefix       → New title prefix\nREQUEST_PLAN:          → REQUEST:\nELICIT:                → ELICIT: (unchanged)\nPROPOSE_PLAN:          → PROPOSAL-{N}:\nREVIEW:                → PROPOSAL-{N}-REVIEW-{M}:\nRATIFIED_PLAN:         → (add aura:p6-plan:s1-ratify label to PROPOSAL-N)\nIMPLEMENTATION_PLAN:   → IMPL_PLAN:\n\\`\\`\\`\n\n---\n\n## Handoff Transitions (NEW — addresses I5)\n\nFive transitions where actor changes require handoff documents:\n\n| Transition | Source Skill | Target Skill | Provenance |\n|------------|-------------|--------------|------------|\n| Architect → Supervisor | aura:architect:handoff.md | aura:supervisor.md | Full inline |\n| Supervisor → Worker | aura:supervisor:spawn-worker.md | aura:worker.md | Summary + IDs |\n| Supervisor → Reviewer | aura:impl:review.md | aura:reviewer:review-code.md | Summary + IDs |\n| Worker → Reviewer | aura:worker:complete.md | aura:reviewer:review-code.md | Summary + IDs |\n| Reviewer → Followup | aura:impl:review.md | aura:supervisor.md (followup) | Summary + IDs |\n\nSame-actor transitions (NO handoff doc needed):\n- UAT → Ratify (same architect)\n- Ratify → Handoff (same architect)\n\nStorage: .git/.aura/handoff/{request-task-id}/{source}-to-{target}.md\nFor follow-up epics: .git/.aura/handoff/{followup-task-id}/{source}-to-{target}.md\n\n---\n\n## Vocabulary Reconciliation (NEW — addresses I6)\n\nOld (deprecated) → New:\n\n\\`\\`\\`\nVotes:\n  APPROVE                → ACCEPT\n  APPROVE_WITH_COMMENTS  → ACCEPT (findings tracked as IMPORTANT/MINOR)\n  REQUEST_CHANGES        → REVISE\n  REJECT                 → REVISE (with BLOCKER findings)\n\nSeverity:\n  BLOCKING → BLOCKER\n  MAJOR    → IMPORTANT\n  MINOR    → MINOR (unchanged)\n\\`\\`\\`\n\nThe old 4-level vote system collapses to binary ACCEPT/REVISE because:\n- APPROVE_WITH_COMMENTS = ACCEPT + the severity tree captures the comments\n- REQUEST_CHANGES vs REJECT = both are REVISE, severity of findings determines urgency\n\n---\n\n## BDD Acceptance Criteria\n\n(Includes new criteria addressing review findings)\n\n**Given** an agent runs /aura:epoch\n**When** it reaches Phase 1\n**Then** it performs classify (s1_1), research (s1_2 parallel), explore (s1_3 parallel)\n**Should Not** skip classification or proceed without user confirmation of research depth\n\n**Given** a code review round completes with findings\n**When** findings are recorded\n**Then** severity groups are created ONLY for severities that have findings (lazy creation)\n**Should Not** create empty severity groups\n\n**Given** a code review round completes with BLOCKER findings\n**When** severity groups are wired\n**Then** the BLOCKER group gets dual-parent: blocks both review-round AND slice via two bd dep add calls\n**Should Not** only block the review-round (would allow slice to close with unresolved blockers)\n\n**Given** a slice has an unresolved BLOCKER severity group\n**When** the slice attempts to close\n**Then** the BLOCKER group prevents closure (it is a blocking dependency)\n**Should Not** close a slice with unresolved BLOCKER findings\n\n**Given** all BLOCKERs are resolved and IMPORTANT/MINOR findings remain\n**When** the supervisor checks review status after Phase 10\n**Then** the supervisor creates EPIC_FOLLOWUP and IMPORTANT/MINOR leaf tasks gain followup-slice as new parent\n**Should Not** lose IMPORTANT/MINOR findings when the original epic closes\n\n**Given** a phase transition between different actors\n**When** handing off\n**Then** a handoff document is written to .git/.aura/handoff/{request-id}/\n**Should Not** transition without creating the handoff document\n\n**Given** a proposal is superseded\n**When** PROPOSAL-N+1 is created\n**Then** PROPOSAL-N gets aura:superseded label AND a comment linking to N+1\n**Should Not** leave the old proposal unmarked\n\n**Given** a plan review (Phase 4)\n**When** reviewer votes\n**Then** vote is binary ACCEPT/REVISE with structured comments (no severity tree)\n**Should Not** apply the BLOCKER/IMPORTANT/MINOR severity tree to plan reviews\n\n---\n\n## Validation Checklist\n\n### Slice 1: Protocol core + label schema (PREREQUISITE for all other slices)\n- [ ] protocol/CLAUDE.md: new label format, review severity tree, dual-parent, follow-up epic, vocabulary reconciliation\n- [ ] protocol/PROCESS.md: expanded Phase 1, review severity, follow-up epic, migration mapping, handoff transitions\n- [ ] protocol/CONSTRAINTS.md: replace old vote/severity tables with ACCEPT/REVISE + BLOCKER/IMPORTANT/MINOR\n- [ ] protocol/UAT_TEMPLATE.md: update label references\n- [ ] protocol/HANDOFF_TEMPLATE.md (CREATE): standardized handoff template\n- [ ] protocol/MIGRATION_v1_to_v2.md (CREATE): full migration procedure with label + title mapping\n- [ ] **Consistency check:** grep all protocol/ for old labels (aura:plan:propose, aura:impl, etc.)\n\n### Slice 2: Phase 1-2 skills (blocked by Slice 1)\n- [ ] aura:epoch.md: expanded Phase 1, follow-up epic, new labels, 12-phase with step suffixes\n- [ ] aura:user:request.md: s1_1-classify, s1_2-research, s1_3-explore sub-steps, new labels\n- [ ] aura:user:elicit.md: URD creation as s2_2, new labels\n- [ ] **Consistency check:** grep commands/aura:epoch.md commands/aura:user:*.md for old labels\n\n### Slice 3: Phase 3-7 skills — architect, reviewer, plan (blocked by Slice 1)\n- [ ] aura:plan.md: new labels, URD reference\n- [ ] aura:architect.md: new labels, follow-up epic awareness, vocabulary reconciliation\n- [ ] aura:architect:propose-plan.md: PROPOSAL-N naming, new labels\n- [ ] aura:architect:request-review.md: REVIEW-M naming, severity tree instructions for code review\n- [ ] aura:architect:ratify.md: superseded marking, new labels\n- [ ] aura:architect:handoff.md: handoff template, .git/.aura/handoff/ storage, new labels\n- [ ] aura:reviewer.md: ACCEPT/REVISE vocabulary, severity tree for code review, no severity tree for plan review\n- [ ] aura:reviewer:review-plan.md: ACCEPT/REVISE only, structured comments, new labels\n- [ ] aura:reviewer:review-code.md: full severity tree procedure with dual-parent bd commands, remove RFC content\n- [ ] aura:reviewer:comment.md: BLOCKER/IMPORTANT/MINOR vocabulary, remove old BLOCKING/MAJOR\n- [ ] aura:reviewer:vote.md: ACCEPT/REVISE only, severity tree awareness\n- [ ] aura:feedback.md: reconcile to ACCEPT/REVISE + BLOCKER/IMPORTANT/MINOR, deprecate old vocabulary\n- [ ] **Consistency check:** grep commands/aura:architect*.md commands/aura:reviewer*.md commands/aura:feedback.md for old labels/vocabulary\n\n### Slice 4: Phase 8-12 skills — supervisor, worker, impl (blocked by Slice 1)\n- [ ] aura:supervisor.md: follow-up epic creation (trigger + owner), new labels\n- [ ] aura:supervisor:plan-tasks.md: SLICE-N naming, new labels\n- [ ] aura:supervisor:track-progress.md: severity tree awareness, new labels\n- [ ] aura:supervisor:spawn-worker.md: new labels, handoff template for Supervisor→Worker\n- [ ] aura:supervisor:commit.md: new labels\n- [ ] aura:impl:review.md: full severity tree procedure, SLICE-N-REVIEW naming, handoff for Supervisor→Reviewer and Reviewer→Followup\n- [ ] aura:impl:slice.md: new labels\n- [ ] aura:worker.md: new labels\n- [ ] aura:worker:implement.md: new labels\n- [ ] aura:worker:complete.md: handoff template for Worker→Reviewer, new labels\n- [ ] aura:worker:blocked.md: new labels\n- [ ] aura:user:uat.md: new labels (p5 for plan UAT, p11 for impl UAT)\n- [ ] **Consistency check:** grep commands/aura:supervisor*.md commands/aura:worker*.md commands/aura:impl*.md for old labels\n\n### Slice 5: Utility + messaging skills (blocked by Slice 1)\n- [ ] aura:status.md: update all label references to new format\n- [ ] aura:test.md: minimal — update any label references\n- [ ] aura:msg:send.md: update examples to new naming\n- [ ] aura:msg:broadcast.md: update examples to new naming\n- [ ] aura:msg:receive.md: update examples to new naming\n- [ ] aura:msg:ack.md: update examples to new naming\n- [ ] **Consistency check:** grep commands/aura:status.md commands/aura:test.md commands/aura:msg*.md for old labels\n\n## Files Affected (40 total)\n\n### Protocol (modify: 4, create: 2)\n- protocol/CLAUDE.md (FULL)\n- protocol/PROCESS.md (FULL)\n- protocol/CONSTRAINTS.md (FULL)\n- protocol/UAT_TEMPLATE.md (MODERATE)\n- protocol/HANDOFF_TEMPLATE.md (CREATE)\n- protocol/MIGRATION_v1_to_v2.md (CREATE)\n\n### Phase 1-2 skills (modify: 3, change depth: FULL)\n- commands/aura:epoch.md\n- commands/aura:user:request.md\n- commands/aura:user:elicit.md\n\n### Phase 3-7 skills (modify: 12, change depth varies)\n- commands/aura:plan.md (MODERATE)\n- commands/aura:architect.md (FULL)\n- commands/aura:architect:propose-plan.md (MODERATE)\n- commands/aura:architect:request-review.md (MODERATE)\n- commands/aura:architect:ratify.md (MODERATE)\n- commands/aura:architect:handoff.md (FULL — handoff template)\n- commands/aura:reviewer.md (FULL — severity tree + vocabulary)\n- commands/aura:reviewer:review-plan.md (MODERATE)\n- commands/aura:reviewer:review-code.md (FULL — severity tree procedure)\n- commands/aura:reviewer:comment.md (FULL — vocabulary reconciliation)\n- commands/aura:reviewer:vote.md (MODERATE)\n- commands/aura:feedback.md (FULL — vocabulary reconciliation or deprecation)\n\n### Phase 8-12 skills (modify: 12, change depth varies)\n- commands/aura:supervisor.md (FULL — follow-up epic owner)\n- commands/aura:supervisor:plan-tasks.md (MODERATE)\n- commands/aura:supervisor:track-progress.md (MODERATE)\n- commands/aura:supervisor:spawn-worker.md (MODERATE — handoff template)\n- commands/aura:supervisor:commit.md (MINIMAL)\n- commands/aura:impl:review.md (FULL — severity tree + handoff)\n- commands/aura:impl:slice.md (MODERATE)\n- commands/aura:worker.md (MODERATE)\n- commands/aura:worker:implement.md (MODERATE)\n- commands/aura:worker:complete.md (MODERATE — handoff template)\n- commands/aura:worker:blocked.md (MINIMAL)\n- commands/aura:user:uat.md (MODERATE)\n\n### Utility + messaging (modify: 6, change depth: MINIMAL)\n- commands/aura:status.md (MODERATE — many label references)\n- commands/aura:test.md (MINIMAL)\n- commands/aura:msg:send.md (MINIMAL)\n- commands/aura:msg:broadcast.md (MINIMAL)\n- commands/aura:msg:receive.md (MINIMAL)\n- commands/aura:msg:ack.md (MINIMAL)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-5eh","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"open","target":"","timeout_ns":0,"title":"PROPOSAL-2: Aura protocol v2 — MVP skill \u0026 process updates","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"dbd3d206ae67a6416311a661e3da300daf8366e7b08c2a51233c7721b96c4ee1","created_at":"2026-02-18T13:50:39Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"Phase 3 proposal — see beads comments for full plan","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-5fk","is_template":0,"issue_type":"feature","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"open","target":"","timeout_ns":0,"title":"PROPOSE_PLAN: aura-scripts Nix flake with HM modules for unified agent config","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":"2026-02-20T23:01:10Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"7ee076454e0a06e309ea5e6e0fa3e357eff6ad388cb65925d40597e6c285ed67","created_at":"2026-02-20T23:01:00Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-5ud","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"ACCEPT. All 4 REVISE changes from Round 1 verified addressed. No remaining test quality issues.","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"PROPOSAL-2-REVIEW-B-2: Test quality review","updated_at":"2026-02-20T23:01:10Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T10:22:51Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"24ba4bdd70ede0d52cf398e5f7e6adaa52d757db17ae3e487f2e48709147e09e","created_at":"2026-02-20T10:13:57Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"Important findings from Reviewer A (Correctness)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-5x1","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"IMPL-REVIEW-A-1 IMPORTANT","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T10:22:51Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"9a09baf62573fb17325a89f15d87091c404cb62f0ed7a3fdfd892ec80d609522","created_at":"2026-02-20T10:13:57Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"Blocker findings from Reviewer A (Correctness)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-60r","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"IMPL-REVIEW-A-1 BLOCKER","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"1e1c6b08d6ee873250702880b5810f7d293c5bdf38520e6336bc464053655c66","created_at":"2026-02-20T22:53:14Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"---\nreferences:\n  request: aura-2o8\n  elicit: aura-xw6\n---\n## Requirements\n\n### R1: Two-hook architecture\n- **aura-prime** hook (SessionStart + PreCompact): Injects full CLAUDE.md content into every session\n- **aura-context** hook (PreToolUse on Skill tool): Parses schema.xml, injects doc pointers + skill hints\n\n### R2: aura-prime behavior\n- Triggered on SessionStart and PreCompact events\n- Always outputs full protocol/CLAUDE.md content (~400 lines, ~6k tokens)\n- Pattern follows bd-prime from Beads (same hook events, same injection mechanism)\n- Output via systemMessage in stdout JSON\n\n### R3: Schema extension — context-defaults with phase overrides\n- New \u003ccontext-defaults\u003e section in schema.xml\n- \u003crole-context\u003e entries define default docs per role\n- Optional \u003cphase-override\u003e for phase-specific additions\n- Worker: CONSTRAINTS.md only (NO PROCESS.md)\n- Architect/Supervisor/Reviewer: PROCESS.md + CONSTRAINTS.md\n\n### R4: Skill hints (default + custom)\n- Default hints: auto-generated from schema (list available skills at current phase for current role)\n- Custom hints: defined in \u003ctransition\u003e elements with \u003chint\u003e child text\n- Used for triggers/conditional handoffs (e.g., \"all ACCEPT → run /aura:user:uat\")\n\n### R5: Transition hints in schema.xml\n- Extend existing \u003ctransition\u003e elements with \u003chint\u003e child containing human-readable next-step guidance\n- Schema already defines transitions with conditions — hints add actionable agent instructions\n\n### R6: Packaging\n- Hook scripts live in aura-plugins repo under hooks/ directory\n- Shipped via the plugin system (hooks.json auto-discovered)\n- schema.xml is co-located, no path resolution issues\n\n### R7: SKILL.md cleanup (strip duplicated content)\n- Remove inline Given/When/Then constraints from SKILL.md files that duplicate CLAUDE.md or CONSTRAINTS.md content\n- Keep \"See Also\" navigation links as-is\n- Keep SKILL.md role descriptions and phase-specific instructions\n\n## Priorities\n1. Schema extension (context-defaults + transition hints)\n2. aura-prime hook (SessionStart + PreCompact)\n3. aura-context hook (PreToolUse on Skill)\n4. SKILL.md cleanup (strip duplicated content)\n\n## Design Choices\n- Hybrid injection: full CLAUDE.md on startup/compaction, pointers for everything else\n- Role-level defaults + phase overrides (not per-command)\n- Python implementation using xml.etree.ElementTree for schema parsing\n- Follow bd-prime and agentfilter/hookify patterns for hook implementation\n\n## MVP Goals\n- Schema extension with context-defaults and transition hints\n- aura-prime hook injecting full CLAUDE.md\n- aura-context hook with doc pointers and default skill hints\n- hooks.json configuration wiring both hooks\n\n## End-Vision Goals\n- All 38 SKILL.md files cleaned of duplicated content\n- schema.xml is the single source of truth for what context each role/phase needs\n- Zero manual maintenance of repeated context fragments across skills\n- Agents automatically receive the right context at the right time","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-635","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"## URE Survey Results (Verbatim)\n\n### Q1: Injection Mode\n**Question:** The PreToolUse hook can inject a `systemMessage` into the model's context before the skill loads. Should the hook inject the actual file content of referenced docs (e.g., inline the relevant PROCESS.md section), or should it just tell the agent which files to read?\n\n**Options presented:**\n- **Pointer mode** — Hook outputs a systemMessage like 'For role=supervisor at phase p8, read: CLAUDE.md, PROCESS.md#phase-8, CONSTRAINTS.md. Available skills: plan-tasks, spawn-worker.' The agent then reads files itself. Lower token cost per hook call, but requires extra Read tool calls.\n- **Content injection** — Hook reads the referenced docs and injects their content (or relevant sections) directly into the systemMessage. No extra Read calls needed, but higher token cost per skill invocation. Risk of very large context.\n- **Hybrid** — Inject CLAUDE.md content always (it's the core directive). For PROCESS.md and CONSTRAINTS.md, just provide pointers with anchors. This balances token cost vs. context availability.\n\n**User response (verbatim):** \"Hybrid\" — selected Hybrid option. User note: \"Should only inject CLAUDE.md on startup and post-compaction. Similar to bd-prime hook from Beads.\"\n\n---\n\n### Q2: Migration Strategy\n**Question:** Should the hook strip existing doc references from SKILL.md files (removing the redundant 'See protocol/PROCESS.md' lines), or should we leave them as-is and let the hook add the missing references that aren't already there?\n\n**Options presented:**\n- **Strip and centralize** — Remove all protocol doc references from SKILL.md files. The hook becomes the single source of truth for what docs to inject. Clean separation of concerns, but requires modifying all 38 SKILL.md files.\n- **Additive only** — Leave existing SKILL.md references untouched. The hook adds whatever is missing (e.g., CLAUDE.md for skills that don't reference it). Some redundancy, but less churn.\n- **Strip duplicated content only** — Remove only the content that the hook will inject (e.g., remove inline 'Given/When/Then' constraints that are already in CONSTRAINTS.md). Keep the 'See Also' links as navigation aids.\n\n**User response (verbatim):** \"Strip duplicated content only\" — selected Strip duplicated content only option.\n\n---\n\n### Q3: aura-prime Output Level\n**Question:** For the aura-prime hook (SessionStart + PreCompact), should it inject the full CLAUDE.md content, or should it be adaptive like bd-prime (e.g., shorter output if schema.xml is available for detailed lookups, longer if not)?\n\n**Options presented:**\n- **Full CLAUDE.md always** — Always inject the complete protocol/CLAUDE.md content. Simple, predictable, no conditional logic. ~400 lines / ~6k tokens.\n- **Adaptive** — Detect context and output accordingly. E.g., if inside a beads project with schema.xml available, output a condensed version. If not, output the full CLAUDE.md. Follows bd-prime's adaptive pattern.\n- **Condensed always** — Always inject a condensed version (~1-2k tokens) with the most critical constraints, dependency direction rules, and Git conventions. Full CLAUDE.md available via pointer if agent needs it.\n\n**User response (verbatim):** \"Full CLAUDE.md always\" — selected Full CLAUDE.md always option.\n\n---\n\n### Q4: Schema Design for Doc Injection\n**Question:** For the aura-context PreToolUse hook, schema.xml currently has no mechanism for skill-dependent doc injection. We need to extend it. Should we add a `\u003ccontext-docs\u003e` element to each `\u003ccommand\u003e`, or define the mapping in a separate section that maps roles to required docs?\n\n**Options presented:**\n- **Per-command context-docs** — Add \u003ccontext-docs\u003e inside each \u003ccommand\u003e element listing the docs to inject. Fine-grained control per skill, but 36 commands to annotate.\n  ```xml\n  \u003ccommand id=\"cmd-sup-plan\" name=\"aura:supervisor:plan-tasks\" role-ref=\"supervisor\"\u003e\n    \u003cphases\u003e\u003cphase-ref ref=\"p8\"/\u003e\u003c/phases\u003e\n    \u003cfile\u003eskills/supervisor-plan-tasks/SKILL.md\u003c/file\u003e\n    \u003ccontext-docs\u003e\n      \u003cdoc-ref ref=\"doc-process\" anchor=\"phase-8\"/\u003e\n      \u003cdoc-ref ref=\"doc-constraints\"/\u003e\n    \u003c/context-docs\u003e\n  \u003c/command\u003e\n  ```\n- **Role-phase matrix** — Add a \u003ccontext-matrix\u003e section mapping (role, phase) pairs to required docs. Fewer entries (roles x phases), inherited by all commands in that role+phase. Per-command overrides optional.\n  ```xml\n  \u003ccontext-matrix\u003e\n    \u003centry role-ref=\"supervisor\" phase-ref=\"p8\"\u003e\n      \u003cdoc-ref ref=\"doc-process\" anchor=\"phase-8\"/\u003e\n      \u003cdoc-ref ref=\"doc-constraints\"/\u003e\n    \u003c/entry\u003e\n    \u003centry role-ref=\"worker\" phase-ref=\"p9\"\u003e\n      \u003cdoc-ref ref=\"doc-constraints\"/\u003e\n    \u003c/entry\u003e\n  \u003c/context-matrix\u003e\n  ```\n- **Role-level defaults + overrides** — Define default docs per role, with optional per-command overrides. Most compact: 5 role entries + a few overrides.\n  ```xml\n  \u003ccontext-defaults\u003e\n    \u003crole-context role-ref=\"architect\"\u003e\n      \u003cdoc-ref ref=\"doc-process\"/\u003e\n      \u003cdoc-ref ref=\"doc-constraints\"/\u003e\n    \u003c/role-context\u003e\n    \u003crole-context role-ref=\"worker\"\u003e\n      \u003cdoc-ref ref=\"doc-constraints\"/\u003e\n    \u003c/role-context\u003e\n  \u003c/context-defaults\u003e\n  \u003ccommand id=\"cmd-arch-handoff\"\u003e\n    \u003ccontext-override\u003e\n      \u003cdoc-ref ref=\"doc-handoff\"/\u003e\n    \u003c/context-override\u003e\n  \u003c/command\u003e\n  ```\n\n**User response (verbatim):** \"Role-level defaults + overrides\" — selected Role-level defaults + overrides option. User note: \"Should be a role-level default + optional phase override\"\n\n---\n\n### Q5: Skill Hints\n**Question:** Should the aura-context hook also output which skills are available at the current phase? This helps agents know what to invoke next (e.g., after Phase 3, the architect should invoke /aura:architect:request-review).\n\n**Options presented:**\n- **Yes, include skill hints** — Hook outputs 'Available skills at phase p8: /aura:supervisor:plan-tasks, /aura:supervisor:spawn-worker'. Helps agents navigate the workflow.\n- **No, skills only** — Hook only outputs doc pointers. Agents discover available skills from the SKILL.md they just loaded. Less noise in the systemMessage.\n\n**User response (verbatim):** \"Yes, incude skill hints. There should be a default hint, but for triggers/conditional handoffs, need to write a custom hint.\"\n\n---\n\n### Q6: Custom Hint Storage\n**Question:** For custom skill hints (triggers/conditional handoffs), where should these be defined? They need to express things like 'if all 3 reviewers ACCEPT, proceed to Phase 5 UAT' or 'if any REVISE, loop back to Phase 3'.\n\n**Options presented:**\n- **In schema.xml transitions** — Extend the existing \u003ctransition\u003e elements with a \u003chint\u003e child. The schema already defines transitions with conditions — adding human-readable hints keeps everything in one place.\n  ```xml\n  \u003cphase id=\"p4\" name=\"Review\"\u003e\n    \u003ctransitions\u003e\n      \u003ctransition to-phase=\"p5\" condition=\"all 3 reviewers vote ACCEPT\"\u003e\n        \u003chint\u003eAll reviewers ACCEPT → run /aura:user:uat for Phase 5 Plan UAT\u003c/hint\u003e\n      \u003c/transition\u003e\n      \u003ctransition to-phase=\"p3\" condition=\"any reviewer votes REVISE\"\u003e\n        \u003chint\u003eREVISE vote → run /aura:architect:propose-plan to create PROPOSAL-{N+1}\u003c/hint\u003e\n      \u003c/transition\u003e\n    \u003c/transitions\u003e\n  \u003c/phase\u003e\n  ```\n- **In a separate hints section** — Add a \u003cskill-hints\u003e section in schema.xml that maps (role, phase, condition) to hint text. Decoupled from the phase structure.\n  ```xml\n  \u003cskill-hints\u003e\n    \u003chint role-ref=\"architect\" phase-ref=\"p4\" condition=\"all-accept\"\u003e\n      All reviewers ACCEPT → run /aura:user:uat\n    \u003c/hint\u003e\n  \u003c/skill-hints\u003e\n  ```\n- **In SKILL.md files** — Keep custom hints in the SKILL.md files themselves (a 'Next Steps' section). The hook reads the SKILL.md and extracts the hints section. No schema change needed.\n\n**User response (verbatim):** \"In schema.xml transitions\" — selected In schema.xml transitions option, with the inline code preview shown.\n\n---\n\n### Q7: Packaging\n**Question:** For the implementation, should the Python hook be part of the aura-plugins repo (shipped with the plugin), or a separate standalone script?\n\n**Options presented:**\n- **In aura-plugins repo (Recommended)** — Hook scripts live in aura-plugins under a hooks/ directory. Shipped via the plugin system. Schema.xml is already here, so no path resolution issues.\n- **Separate repo/script** — Hook scripts live in a separate location (e.g., aura-scripts). More modular but adds a dependency.\n\n**User response (verbatim):** \"In aura-plugins repo (Recommended)\" — selected In aura-plugins repo option.\n## URE ADDENDUM: Markdown Preview Hints\n\nThe following questions had markdown preview hints shown alongside their options. These previews are part of the complete elicitation record.\n\n### Q1: Injection Mode — Preview Hints\n\n**Pointer mode preview:**\n```\nsystemMessage: |\n  ## Aura Context (aura:supervisor:plan-tasks)\n  Role: supervisor | Phase: p8 (Impl Plan)\n  \n  Required reading:\n  - skills/protocol/CLAUDE.md (core directive)\n  - skills/protocol/PROCESS.md#phase-8 (workflow)\n  - skills/protocol/CONSTRAINTS.md (standards)\n  \n  Available skills at this phase:\n  - /aura:supervisor:plan-tasks\n  - /aura:supervisor:spawn-worker\n  \n  Labels this skill creates:\n  - aura:p8-impl:s8-plan\n  - aura:p9-impl:s9-slice\n```\n\n**Content injection preview:**\n```\nsystemMessage: |\n  ## Aura Protocol Context\n  \n  ### Core Directive (CLAUDE.md)\n  [full or sectioned content of CLAUDE.md]\n  \n  ### Phase 8: Impl Plan (PROCESS.md)\n  [section content for phase 8]\n  \n  ### Constraints\n  [relevant constraints]\n  \n  ### Available Skills\n  - /aura:supervisor:plan-tasks\n  - /aura:supervisor:spawn-worker\n```\n\n**User choice:** Hybrid (no dedicated preview — combines both approaches: CLAUDE.md on startup, pointers for PROCESS.md/CONSTRAINTS.md)\n\n---\n\n### Q4: Schema Design — Preview Hints\n\n**Per-command context-docs preview:**\n```xml\n\u003ccommand id=\"cmd-sup-plan\" name=\"aura:supervisor:plan-tasks\"\n         role-ref=\"supervisor\"\u003e\n  \u003cphases\u003e\u003cphase-ref ref=\"p8\"/\u003e\u003c/phases\u003e\n  \u003cfile\u003eskills/supervisor-plan-tasks/SKILL.md\u003c/file\u003e\n  \u003ccontext-docs\u003e\n    \u003cdoc-ref ref=\"doc-process\" anchor=\"phase-8\"/\u003e\n    \u003cdoc-ref ref=\"doc-constraints\"/\u003e\n  \u003c/context-docs\u003e\n\u003c/command\u003e\n```\n\n**Role-phase matrix preview:**\n```xml\n\u003ccontext-matrix\u003e\n  \u003centry role-ref=\"supervisor\" phase-ref=\"p8\"\u003e\n    \u003cdoc-ref ref=\"doc-process\" anchor=\"phase-8\"/\u003e\n    \u003cdoc-ref ref=\"doc-constraints\"/\u003e\n  \u003c/entry\u003e\n  \u003centry role-ref=\"worker\" phase-ref=\"p9\"\u003e\n    \u003cdoc-ref ref=\"doc-constraints\"/\u003e\n    \u003c!-- No PROCESS.md for workers --\u003e\n  \u003c/entry\u003e\n\u003c/context-matrix\u003e\n```\n\n**Role-level defaults + overrides preview (USER'S CHOICE):**\n```xml\n\u003ccontext-defaults\u003e\n  \u003crole-context role-ref=\"architect\"\u003e\n    \u003cdoc-ref ref=\"doc-process\"/\u003e\n    \u003cdoc-ref ref=\"doc-constraints\"/\u003e\n  \u003c/role-context\u003e\n  \u003crole-context role-ref=\"worker\"\u003e\n    \u003cdoc-ref ref=\"doc-constraints\"/\u003e\n    \u003c!-- No PROCESS.md --\u003e\n  \u003c/role-context\u003e\n\u003c/context-defaults\u003e\n\n\u003c!-- Optional per-command override --\u003e\n\u003ccommand id=\"cmd-arch-handoff\"\u003e\n  \u003ccontext-override\u003e\n    \u003cdoc-ref ref=\"doc-handoff\"/\u003e\n  \u003c/context-override\u003e\n\u003c/command\u003e\n```\n\n**User note:** \"Should be a role-level default + optional phase override\"\n\n---\n\n### Q6: Custom Hint Storage — Preview Hints\n\n**In schema.xml transitions preview (USER'S CHOICE):**\n```xml\n\u003cphase id=\"p4\" name=\"Review\"\u003e\n  \u003ctransitions\u003e\n    \u003ctransition to-phase=\"p5\"\n      condition=\"all 3 reviewers vote ACCEPT\"\u003e\n      \u003chint\u003eAll reviewers ACCEPT → run /aura:user:uat\n        for Phase 5 Plan UAT\u003c/hint\u003e\n    \u003c/transition\u003e\n    \u003ctransition to-phase=\"p3\"\n      condition=\"any reviewer votes REVISE\"\u003e\n      \u003chint\u003eREVISE vote → run /aura:architect:propose-plan\n        to create PROPOSAL-{N+1}\u003c/hint\u003e\n    \u003c/transition\u003e\n  \u003c/transitions\u003e\n\u003c/phase\u003e\n```\n\n**Separate hints section preview:**\n```xml\n\u003cskill-hints\u003e\n  \u003chint role-ref=\"architect\" phase-ref=\"p4\"\n       condition=\"all-accept\"\u003e\n    All reviewers ACCEPT → run /aura:user:uat\n  \u003c/hint\u003e\n  \u003chint role-ref=\"architect\" phase-ref=\"p4\"\n       condition=\"any-revise\"\u003e\n    REVISE vote → run /aura:architect:propose-plan\n    to create PROPOSAL-{N+1}\n  \u003c/hint\u003e\n\u003c/skill-hints\u003e\n```\n\nQuestions Q2, Q3, Q5, and Q7 did not have markdown preview hints — they only had text descriptions for their options.","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"open","target":"","timeout_ns":0,"title":"URD: Context fragment management via hooks + schema-driven injection","updated_at":"2026-02-20T22:58:58Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"e5babdba8d6e4b17a2a4671256d293d250c297bb4b5cbfacc9c5be59e15be057","created_at":"2026-02-20T22:59:43Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"---\nreferences:\n  request: aura-2o8\n  urd: aura-635\n  supersedes: aura-id1\n---\n## Changes from PROPOSAL-1\n\nAddressed Reviewer B (Test Quality) REVISE feedback:\n1. Renamed MVP item 5 → \"Integration tests for hook pipelines\"\n2. Renamed validation checklist item 10 → \"Integration tests pass for both hooks\"\n3. Added Test Strategy section with 3 explicit commitments\n4. Added validation checklist item 12 for shared test fixtures\nAlso fixed URD R2 discrepancy noted by Reviewer A (aura-prime uses raw text, not JSON systemMessage).\n\n## Problem Space\n\n**Axes:**\n- Parallelism: Low — hooks are sequential (SessionStart before agent starts, PreToolUse before each skill)\n- Distribution: Local — all within one Claude Code session\n- Frequency: aura-prime runs 1-2x/session; aura-context runs once per skill invocation (~5-20x/session)\n- Has-a: schema.xml HAS context-defaults, HAS transition hints; hooks HAVE schema parser\n- Is-a: aura-prime IS a content injector; aura-context IS a context router\n\n## Architecture\n\n### Two hooks, two lifecycles\n\n```\n┌─────────────────────────────────────────────────────┐\n│ SessionStart / PreCompact                           │\n│   aura_prime.py → reads CLAUDE.md → stdout (text)   │\n│   Result: agent has full protocol directive          │\n└─────────────────────────────────────────────────────┘\n\n┌─────────────────────────────────────────────────────┐\n│ PreToolUse (matcher: \"Skill\")                       │\n│   aura_context.py → reads schema.xml → parses       │\n│     → maps skill → role, phase → context-defaults    │\n│     → gets available skills + transition hints       │\n│     → stdout JSON { systemMessage: \"...\" }           │\n│   Result: agent knows what docs to read + next steps │\n└─────────────────────────────────────────────────────┘\n```\n\n### Schema extension: context-defaults + transition hints\n\n```xml\n\u003c!-- NEW: Role-level doc defaults --\u003e\n\u003ccontext-defaults\u003e\n  \u003crole-context role-ref=\"epoch\"\u003e\n    \u003cdoc-ref ref=\"doc-process\"/\u003e\n    \u003cdoc-ref ref=\"doc-constraints\"/\u003e\n  \u003c/role-context\u003e\n  \u003crole-context role-ref=\"architect\"\u003e\n    \u003cdoc-ref ref=\"doc-process\"/\u003e\n    \u003cdoc-ref ref=\"doc-constraints\"/\u003e\n  \u003c/role-context\u003e\n  \u003crole-context role-ref=\"supervisor\"\u003e\n    \u003cdoc-ref ref=\"doc-process\"/\u003e\n    \u003cdoc-ref ref=\"doc-constraints\"/\u003e\n  \u003c/role-context\u003e\n  \u003crole-context role-ref=\"reviewer\"\u003e\n    \u003cdoc-ref ref=\"doc-process\"/\u003e\n    \u003cdoc-ref ref=\"doc-constraints\"/\u003e\n  \u003c/role-context\u003e\n  \u003crole-context role-ref=\"worker\"\u003e\n    \u003cdoc-ref ref=\"doc-constraints\"/\u003e\n    \u003c!-- No PROCESS.md for workers per user requirement --\u003e\n  \u003c/role-context\u003e\n\u003c/context-defaults\u003e\n\n\u003c!-- NEW: Phase-level doc overrides (additive to role defaults) --\u003e\n\u003ccontext-overrides\u003e\n  \u003cphase-override role-ref=\"architect\" phase-ref=\"p7\"\u003e\n    \u003cdoc-ref ref=\"doc-handoff\"/\u003e\n  \u003c/phase-override\u003e\n  \u003cphase-override role-ref=\"supervisor\" phase-ref=\"p10\"\u003e\n    \u003cdoc-ref ref=\"doc-handoff\"/\u003e\n  \u003c/phase-override\u003e\n\u003c/context-overrides\u003e\n\n\u003c!-- EXTENDED: Transition hints in existing \u003ctransition\u003e elements --\u003e\n\u003ctransition to-phase=\"p5\" condition=\"all 3 reviewers vote ACCEPT\"\u003e\n  \u003chint\u003eAll reviewers ACCEPT → run /aura:user:uat for Phase 5 Plan UAT\u003c/hint\u003e\n\u003c/transition\u003e\n```\n\n### File structure\n\n```\naura-plugins/\n├── .claude-plugin/\n│   └── plugin.json           # Extended with hooks section\n├── hooks/\n│   ├── aura_prime.py         # SessionStart + PreCompact\n│   └── aura_context.py       # PreToolUse for Skill tool\n├── skills/\n│   └── protocol/\n│       └── schema.xml        # Extended with context-defaults + hints\n└── tests/\n    ├── fixtures/\n    │   ├── schema_minimal.xml  # Minimal schema fixture for tests\n    │   └── claude_md_stub.md   # Stub CLAUDE.md for tests\n    ├── test_aura_prime.py      # Integration tests for aura-prime hook\n    └── test_aura_context.py    # Integration tests for aura-context hook\n```\n\n## Interfaces\n\n### aura_prime.py output (raw text to stdout, following bd-prime pattern)\n```\n# Aura Protocol - Agent Directive\n[full content of skills/protocol/CLAUDE.md]\n```\n\n### aura_context.py output (JSON to stdout)\n```json\n{\n  \"systemMessage\": \"## Aura Context: aura:supervisor:plan-tasks\\nRole: supervisor | Phase: p8 (Impl Plan) | Domain: impl\\n\\n### Required Reading\\n- skills/protocol/PROCESS.md#phase-8 — Workflow for this phase\\n- skills/protocol/CONSTRAINTS.md — Coding standards\\n\\n### Available Skills (Phase p8, Role supervisor)\\n- /aura:supervisor:plan-tasks — Decompose into vertical slices\\n- /aura:supervisor:spawn-worker — Launch a worker agent\\n\\n### Next Steps\\n- All slices created → proceed to Phase 9\"\n}\n```\n\n### plugin.json hooks section\n```json\n{\n  \"hooks\": {\n    \"SessionStart\": [{\n      \"matcher\": \"\",\n      \"hooks\": [{\n        \"type\": \"command\",\n        \"command\": \"python3 ${CLAUDE_PLUGIN_ROOT}/hooks/aura_prime.py\"\n      }]\n    }],\n    \"PreCompact\": [{\n      \"matcher\": \"\",\n      \"hooks\": [{\n        \"type\": \"command\",\n        \"command\": \"python3 ${CLAUDE_PLUGIN_ROOT}/hooks/aura_prime.py\"\n      }]\n    }],\n    \"PreToolUse\": [{\n      \"matcher\": \"Skill\",\n      \"hooks\": [{\n        \"type\": \"command\",\n        \"command\": \"python3 ${CLAUDE_PLUGIN_ROOT}/hooks/aura_context.py\",\n        \"timeout\": 10\n      }]\n    }]\n  }\n}\n```\n\n## Test Strategy (NEW in PROPOSAL-2)\n\nThree explicit commitments:\n\n1. **Hooks tested as subprocesses** — Tests invoke hooks via `subprocess.run()` with stdin piped, matching how Claude Code invokes them. No in-process function calls.\n\n2. **Real schema.xml used (never mocked)** — Tests use a minimal but real XML fixture derived from schema.xml (containing representative roles, phases, commands, transitions). The XML parser is never mocked — it exercises the real `xml.etree.ElementTree` pipeline.\n\n3. **Shared test fixtures** — Common test inputs (stdin JSON payloads, expected skill names, role/phase combinations) and expected outputs (systemMessage content patterns) defined in a `tests/fixtures/` directory. No inline string literals for values that have fixture equivalents.\n\n## Tradeoffs\n\n| Decision | Chosen | Alternative | Rationale |\n|----------|--------|-------------|-----------|\n| Hook output format | Raw text (prime) / JSON (context) | All JSON | Follows bd-prime pattern for SessionStart; JSON required for PreToolUse systemMessage |\n| Schema location for hints | In \u003ctransition\u003e elements | Separate hints section | Co-locates hints with their conditions; no duplication |\n| Context-defaults granularity | Role-level + phase overrides | Per-command | 5 role entries + few overrides vs 36 command entries; user preference |\n| XML parser | xml.etree.ElementTree (stdlib) | lxml | No external dependency; fast enough for 1237-line schema |\n| SKILL.md cleanup | Strip duplicated G/W/T only | Strip all references | Preserves See Also navigation; minimal churn |\n| Test strategy | Subprocess integration tests | Unit tests with mocked parser | Matches production invocation pattern; exercises real XML pipeline |\n\n## MVP Scope\n\n**In MVP:**\n1. schema.xml extension (context-defaults, context-overrides, transition hints for all 12 phases)\n2. aura_prime.py hook (SessionStart + PreCompact, raw text output)\n3. aura_context.py hook (PreToolUse on Skill, JSON systemMessage output)\n4. plugin.json hooks configuration\n5. Integration tests for hook pipelines (subprocess invocation with real schema.xml fixture)\n\n**Phase 2 (follow-up):**\n- SKILL.md cleanup (strip duplicated content from 38 files)\n- Validation that stripped content matches what hooks inject\n- Performance benchmarking of schema parsing\n\n## Validation Checklist\n- [ ] 1. schema.xml has context-defaults section with all 5 roles\n- [ ] 2. schema.xml has context-overrides section with phase-specific additions\n- [ ] 3. schema.xml transitions have hint children for all conditional transitions\n- [ ] 4. aura_prime.py outputs full CLAUDE.md content on stdout (raw text)\n- [ ] 5. aura_context.py parses schema.xml and outputs correct doc pointers as JSON systemMessage\n- [ ] 6. aura_context.py outputs available skills for current role+phase\n- [ ] 7. aura_context.py outputs transition hints for current phase\n- [ ] 8. plugin.json has all 3 hook entries (SessionStart, PreCompact, PreToolUse)\n- [ ] 9. Hook exits 0 on all error paths (never blocks operations)\n- [ ] 10. Integration tests pass for both hooks (stdin-to-stdout against real schema.xml fixture)\n- [ ] 11. Type checking passes\n- [ ] 12. Shared test fixtures exist for schema.xml and CLAUDE.md content\n\n## BDD Acceptance Criteria\n\nGiven SessionStart event\nWhen aura_prime.py executes\nThen stdout contains full CLAUDE.md content (raw text, not JSON)\nShould never output empty or partial content\n\nGiven PreCompact event\nWhen aura_prime.py executes\nThen stdout contains full CLAUDE.md content (same as SessionStart)\nShould never fail silently\n\nGiven Skill tool invocation with skill=\"aura:supervisor:plan-tasks\"\nWhen aura_context.py receives stdin JSON\nThen stdout JSON systemMessage contains:\n  - Doc pointers for supervisor role (PROCESS.md + CONSTRAINTS.md)\n  - Available skills at phase p8\n  - Transition hints for phase p8\nShould never contain docs for wrong role\n\nGiven Skill tool invocation with skill=\"aura:worker:implement\"\nWhen aura_context.py receives stdin JSON\nThen stdout JSON systemMessage contains:\n  - Doc pointers for worker role (CONSTRAINTS.md only, NO PROCESS.md)\n  - Available skills at phase p9\nShould never include PROCESS.md for worker role\n\nGiven schema.xml with context-defaults and phase-override for architect at p7\nWhen aura_context.py processes skill=\"aura:architect:handoff\"\nThen stdout includes HANDOFF_TEMPLATE.md pointer in addition to role defaults\nShould never replace role defaults with override (additive)\n\nGiven malformed stdin JSON\nWhen aura_context.py tries to parse\nThen exits 0 (allow operation)\nShould never exit non-zero or block the skill invocation\n\nGiven unknown skill name not in schema.xml\nWhen aura_context.py looks up context\nThen outputs empty systemMessage or skips injection\nShould never crash or block\n\nGiven integration test for aura_prime.py\nWhen test invokes hook as subprocess with no stdin\nThen subprocess exits 0 and stdout contains CLAUDE.md header\nShould never import hook functions directly (must test as subprocess)\n\nGiven integration test for aura_context.py\nWhen test pipes skill invocation JSON to subprocess stdin\nThen subprocess exits 0 and stdout is valid JSON with systemMessage key\nShould never mock the XML parser","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-6j5","is_template":0,"issue_type":"feature","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"open","target":"","timeout_ns":0,"title":"PROPOSAL-2: Schema-driven context hooks for aura-plugins","updated_at":"2026-02-20T22:59:43Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T10:14:45Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"aad663d1c53ad527293307f81875a5f4c3fc76875617ba91aac9d849e65cd43f","created_at":"2026-02-20T03:08:43Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"Vote: REVISE\n\nBLOCKER findings:\n1. 13 skill files missing from Files Affected (worker:*, supervisor:spawn-worker, supervisor:commit, feedback, status, reviewer:comment, reviewer:vote, msg:*)\n2. Dual-parent BLOCKER relationship not operationalized — needs concrete bd dep add command sequences in reviewer skills\n\nIMPORTANT findings:\n3. Follow-up epic creation trigger ambiguous — no skill assigned as owner\n4. Empty severity group closure not in BDD criteria\n5. Worker-to-Reviewer and Reviewer-to-Followup handoff transitions not assigned to skills\n6. aura:feedback.md and aura:reviewer:comment.md use conflicting old vote/severity vocabulary\n\nMINOR findings:\n7. Label step numbering inconsistent (s1_1 vs s1)\n8. Plan review vs code review severity scope not clarified\n9. protocol/user-request-revamp-v2.md not addressed","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-6om","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"PROPOSAL-1-REVIEW-B-1: Plan review (Reviewer B: Test quality)","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"01f06fa3ab802496308491422352718d91abadf973097baebe70f560a83ad936","created_at":"2026-02-20T22:56:53Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"---\nreferences:\n  request: aura-2o8\n  urd: aura-635\n  proposal: aura-id1\n---\n## VOTE: ACCEPT\n\nAxis A review (Correctness: Spirit and Technicality) of PROPOSAL-1.\n\n### Assessment Summary\n\nAll 6 end-user alignment criteria satisfied:\n1. End-users clearly identified (AI agents + human operator)\n2. User need faithfully addressed (schema-driven context injection)\n3. Net positive impact with user-approved tradeoffs\n4. One minor URD-to-proposal divergence on aura_prime output format (non-blocking, URD documentation issue)\n5. MVP scope well-scoped and achievable\n6. Validation checklist + BDD criteria are complete and independently testable\n\n### Minor Notes (non-blocking)\n- URD R2 says aura_prime outputs via systemMessage JSON but proposal uses raw text (following bd-prime pattern). Recommend updating URD to align.\n- Validation checklist could be more explicit about which phase overrides are MVP-required and about stdin JSON parsing as a distinct testable step.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-6t0","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"open","target":"","timeout_ns":0,"title":"PROPOSAL-1-REVIEW-A-1: Schema-driven context hooks for aura-plugins","updated_at":"2026-02-20T22:56:53Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T10:22:52Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"0dac0a1be9496807b680f34ee5eb70a3c1d88cdaf76c73378de64fb9d72e11d9","created_at":"2026-02-20T10:14:00Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"Important findings from Reviewer C (Elegance)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-7ea","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"IMPL-REVIEW-C-1 IMPORTANT","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T10:14:46Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"ffdbf18aafb4918602b73a2f8daa8e754f99a116f5c5da6c5994e5cb73774810","created_at":"2026-02-20T03:13:44Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"Vote: ACCEPT\n\nBoth Round 1 BLOCKERs RESOLVED:\n- C1: Migration procedure complete with additive labels, dual-recognition, no retroactive restructuring\n- C2: 12-phase numbering justified by step-type suffixes and user choice in URE Q1\n\nMINOR:\n1. Label mapping has aura:impl:uat as old form but codebase uses both aura:user:uat and aura:impl:uat — note both\n2. File count off-by-one (40 vs 39)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-7fs","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"PROPOSAL-2-REVIEW-C-1: Plan review (Reviewer C: Elegance)","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Unnecessary separate epic — REQUEST task (ght) is the epic","closed_at":"2026-02-18T14:04:56Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"db76394e8d0ce73c31cca392f0937f0147f9ccdfd6c600d4641e5a1db02fffde","created_at":"2026-02-18T14:02:31Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"Turn aura-scripts into a consumable Nix flake that exports homeManagerModules and packages for declarative management of Claude Code and OpenCode configuration.\n\nEnd-user: The developer (minttea) who maintains agent configs across Claude Code and OpenCode.\nEnd-goal: One Nix option set generates all agent config files. No manual syncing.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-7o2","is_template":0,"issue_type":"feature","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":1,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"EPIC: Unified agent config — aura-scripts as Nix flake with HM modules","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"architect","await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"6dcd7f66cc4439298561d8d952eacab5eb4ace3c46ffe66b412b816fda9484ae","created_at":"2026-02-19T23:33:42Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"Should devise a new architectural approach to the commands, process, and constraints that make it harder for work to get lost or forgotten about, for certain recurring issues to be addressed via improved validation pipelines, and for better process management and handoff. Improved human handoff would look something like the @protocol/HANDOFF_EXAMPLE-*.md files. Want to also define an explicit Beads schema and taxonomy with with labels that apply to each phase, task, review, UAT, URE, URD, IMPL_PLAN. Labels are being applied non-uniformly, often forgotten about and in a non-standardized manner.\n\nShould look something like this:\n\nThe PROPOSAL-1 and PROPOSAL-2 should be a child of the URE.\n\nWhat we want:\n```\nREQUEST\n  └── blocked by URE\n        └── blocked by PROPOSAL-1 (closed, superseded)\n              └── blocked by PROPOSAL-1-REVIEW-1 (closed)\n              └── blocked by PROPOSAL-1-REVIEW-2 (closed)\n              └── blocked by PROPOSAL-1-REVIEW-3 (closed)\n        └── blocked by PROPOSAL-{2,3,...,N-1} (closed, superseded)\n              └── blocked by PROPOSAL-{K, for proposal number K}-REVIEW-1 (closed)\n              └── blocked by PROPOSAL-{K, for proposal number K}-REVIEW-2 (closed)\n              └── blocked by PROPOSAL-{K, for proposal number K}-REVIEW-3 (closed)\n        └── blocked by PROPOSAL-N (open, aura:plan:ratify)\n              └── blocked by PROPOSAL-N-REVIEW-1 (closed)\n              └── blocked by PROPOSAL-N-REVIEW-2 (closed)\n              └── blocked by PROPOSAL-N-REVIEW-3 (closed)\n              └── blocked by IMPL_PLAN\n                    ├── blocked by slice-1\n                    │     ├── blocked by leaf-task-a\n                    │     └── blocked by leaf-task-b\n                    └── blocked by slice-2\n                          ├── blocked by leaf-task-c\n                          └── blocked by leaf-task-d\n```\n\nHere is an actual example:\n```\nunified-schema-t9d: REQUEST: Aura ingest CLI command - data ingestion pipeline for Claude and OpenCode transcripts [P1] (open) [READY]\n    └── unified-schema-m3l: URE: Aura ingest pipeline requirements elicitation [P1] (open)\n    │   ├── unified-schema-apj: PROPOSAL-1: RFC v0.1.0 Aura ingest pipeline [P1] (closed)\n        └── unified-schema-hjy: PROPOSAL-2: RFC v0.2.0 Aura ingest pipeline (revised) [P1] (open)\n        │   ├── unified-schema-fuf: IMPL_PLAN: Aura ingest pipeline — 10 vertical slices (S1-S10) [P1] (open)\n        │   │   ├── unified-schema-bq9: IMPL-UAT-1: Group A implementation acceptance (S2, S4, S5) [P2] (closed)\n        │   │   ├── unified-schema-er6: Review Round 2: blocking fix verification [P2] (closed)\n        │   │   ├── unified-schema-i80: Code Review: Adapter Slices S6-S8 [P2] (closed)\n        │   │   ├── unified-schema-n6c: Code Review: Pipeline + CLI (S9-S10) [P2] (closed)\n        │       └── unified-schema-o20: Code Review: Foundation Slices S1-S5 [P2] (closed)\n            └── unified-schema-zj9: UAT-1: Plan acceptance for aura ingest pipeline RFC v0.2.0 [P2] (closed)\n```\n\nReviews rounds on the completed vertical slices in the IMPL_PLAN tend to create tasks that get lost. Unsure how to best account for them at the moment. Currently have this other FOLLOW_UP epic issue tracker that takes the Review Rounds / Code Reviews (these names need to be standardized) on the IMPL_PLAN, then takes the tasks generated from them, and then proposes architecture and designs that will resolve the issues the reviewers had.\n\nIdeally, there would be a follow-up epoch where: architect should propose new architecture, should also plan architectural changes or make a design that understands and prevents these issues, how they arise, and prevent them from arising in the future. Could be architecture, design, or just new, better validation rules via `go fmt` or `go vet` or ast-grep rules. launch the supervisor using the `@~/codebases/dayvidpham/aura-scripts/aura-swarm` command once the architecture is proposed to resolve all these issues, and the tasks are topologically sorted and placed into vertical slices.\n\nThis would be generic though, not specific to a golang codebase---just using these command as an example. This would produce a followup-epic with structure like so:\n\n```\nunified-schema-ldl: EPIC: Ingest Pipeline Follow-Up Work (post-implementation) [P2] (closed)\n    ├── unified-schema-f6f: F1: HostSlug \u0026 Project Identity Refactoring [P2] (closed)\n    │   ├── unified-schema-af6: R3: Adapters populate HostSlug, pipeline reads it [P2] (closed)\n    │   ├── unified-schema-da3: R2: Extract shared DeriveProjectIdentifiers into hostslug.go [P2] (closed)\n    │   ├── unified-schema-xvo: R1: Add HostSlug field to UnifiedMetadata [P2] (closed)\n        └── unified-schema-kip: M5: DeriveHostSlug doesn't handle git:// or file:// remotes [P3] (closed)\n    ├── unified-schema-02c: F7: Documentation [P3] (closed)\n    │   ├── unified-schema-z6u: ARCH: Preventive Architecture for Ingest Pipeline Follow-Up [P2] (open)\n    │   ├── ... (many more follow-up tasks organized by feature area)\n    └── unified-schema-qeb: F4: Pipeline Error Handling \u0026 Test Coverage [P3] (closed)\n        ├── ... (leaf tasks)\n```\n\nKey problems to solve:\n1. Work gets lost or forgotten — need harder guardrails\n2. Labels applied non-uniformly — need explicit schema/taxonomy\n3. Review round tasks get lost under IMPL_PLAN — need standardized naming and structure\n4. No formal follow-up epic workflow — need architecture for post-impl review → follow-up epoch\n5. Handoff quality inconsistent — need standardized handoff documents like HANDOFF_EXAMPLE-*.md\n6. Validation pipelines missing — need language-agnostic validation rule system (like go vet, ast-grep)\n7. Process management gaps — recurring issues not systematically prevented","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-82j","is_template":0,"issue_type":"epic","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"open","target":"","timeout_ns":0,"title":"REQUEST: Redesign Aura protocol architecture — standardized Beads schema, label taxonomy, follow-up epic workflow, and improved handoff","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"0f843d1a85947fa7499b5ae85854700b81b99302b2453ea9452ebb2b5ed378fa","created_at":"2026-02-18T14:11:05Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"REVISION-2: Addressing review findings from REVIEW_1 (ACCEPT), REVIEW_2 (REVISE), REVIEW_3 (ACCEPT).\n\n## What Changed from REVISION-1\n\n### 1. Acknowledged existing implementation (Phases 1-3 DONE)\n\nThe HM module (`nix/hm-module.nix`) and flake already implement:\n- Flake skeleton with `packages` output (launch-parallel, aura-swarm)\n- `aura-protocol` — protocol docs install to `~/.claude/` or `~/.config/aura/protocol/`\n- `aura-commands` — slash command `.md` files with role filtering and `enableAll` pattern\n- `aura-agents` — agent `.md` files into `~/.claude/agents/` (was undocumented in REVISION-1)\n- `packages` toggle — installable via `home.packages` when `packages.enable = true`\n\n### 2. Added `agents` section to spec\n\n```nix\nagents = {\n  enable = mkOption { type = bool; default = true; };\n  extraAgents = mkOption { type = attrsOf path; default = {}; };\n};\n```\nEffect: Installs all `.md` files from `agents/` into `~/.claude/agents/`, plus any user-supplied extras.\n\n### 3. Fixed `protocol.target` to match implementation\n\nProposal REVISION-1 said `enum [\"claude\" \"opencode\" \"both\"]`.\nImplementation correctly uses `enum [\"global\" \"xdg\"]`:\n- `\"global\"` → `~/.claude/`\n- `\"xdg\"` → `~/.config/aura/protocol/`\n\nThis avoids premature OpenCode coupling. OpenCode support is its own phase.\n\n### 4. Reframed phases to reflect actual remaining work\n\nOLD phases (REVISION-1):\n1. Flake skeleton + packages ← ALREADY DONE\n2. aura-protocol HM module ← ALREADY DONE\n3. aura-commands HM module ← ALREADY DONE\n4. aura-agent-config HM module\n5. Integration test\n\nNEW phases:\n1. **Fix package wrapping** — Replace `writeScriptBin` with `writeShellApplication` or `makeWrapper` so runtime deps (tmux, git, claude) are in PATH\n2. **Fix `lib ? config.lib`** — Remove non-standard fallback, use `lib` from module args directly\n3. **Integration test** — Wire into dotfiles flake, verify `home-manager switch` produces correct output\n4. **agentConfig HM module** — Generate `~/.claude/settings.json` from Nix options (Claude Code first). Must address `home.file` read-only symlink constraint — settings.json needs writeback, so use `home.file.*.text` with `home.activation` script or `xdg.configFile` with mutable copy\n5. **OpenCode config generation** — Translate shared options to OpenCode config format (own phase, not a parenthetical)\n\n### 5. Runtime dependency wrapping (G1 — all reviewers flagged)\n\nCurrent `writeScriptBin` only patches the shebang. `launch-parallel.py` calls `subprocess` to launch tmux sessions — tmux won't be found unless separately in PATH. `aura-swarm` likely needs git and claude CLI.\n\nFix: Use `writeShellApplication` which supports `runtimeInputs`:\n```nix\nlaunch-parallel = pkgs.writeShellApplication {\n  name = \"launch-parallel\";\n  runtimeInputs = [ pkgs.python3 pkgs.tmux pkgs.git ];\n  text = ''exec python3 ${./launch-parallel.py} \"$@\"'';\n};\n```\n\nOr use `makeWrapper`/`wrapProgram` on the existing derivation.\n\n### 6. `home.file` immutability and Phase 4 design (T1)\n\n`home.file.*.source = storePath` creates read-only `/nix/store` symlinks. Fine for commands, agents, protocol docs. **Blocker for Phase 4**: Claude Code writes to `settings.json` at runtime.\n\nOptions for Phase 4:\n- **A) `home.activation` script**: Generate settings.json to a temp location, copy (not symlink) on activation. User edits persist until next `home-manager switch`.\n- **B) Nix-managed read-only + runtime overlay**: Generate base config from Nix, Claude Code reads base + writes overrides to a separate file, merge at startup.\n- **C) `home.file.*.text` + `home.file.*.force`**: Overwrite on each switch. Simplest but loses runtime changes.\n\nRecommend **Option A** for Phase 4 — defer detailed design to that phase.\n\n### 7. Updated validation checklist (separated by phase)\n\n**Phase 1 (package wrapping):**\n- [ ] `launch-parallel` finds tmux at runtime without tmux in user PATH\n- [ ] `aura-swarm` finds git and claude at runtime\n- [ ] `nix flake show` produces expected outputs\n- [ ] `nix flake check` passes\n\n**Phase 2 (lib fix):**\n- [ ] Remove `lib ? config.lib`, verify module still evaluates correctly\n\n**Phase 3 (integration test):**\n- [ ] Dotfiles flake imports aura-scripts without conflicts\n- [ ] `home-manager switch` completes successfully\n- [ ] Slash commands appear in `~/.claude/commands/`\n- [ ] Agent files appear in `~/.claude/agents/`\n- [ ] Protocol docs appear when `protocol.enable = true`\n- [ ] `enableAll=false` with individual role enables works\n- [ ] `extraCommands` and `extraAgents` extension points work\n- [ ] `protocol.target = \"xdg\"` installs to correct location\n- [ ] No `home.file` attr collisions across sections\n\n**Phase 4 (agentConfig — future):**\n- [ ] `home-manager switch` produces correct `~/.claude/settings.json`\n- [ ] Settings.json writeback strategy works at runtime\n\n**Phase 5 (OpenCode — future):**\n- [ ] OpenCode config generated when `opencode.enable = true`\n\n## Architecture (unchanged from REVISION-1)\n\nSingle module at `CUSTOM.programs.aura-config-sync` with subsections: `packages`, `commands`, `agents`, `protocol`, and future `agentConfig`, `security`, `hooks`.\n\n## Tradeoffs (updated)\n\n| Decision | Chosen | Alternative | Rationale |\n|----------|--------|-------------|-----------|\n| Config generation | Pure Nix functions | Runtime Go/TS daemon | Simpler, reproducible, no state |\n| Module granularity | 1 module, N subsections | N separate modules | Single import, composable via enables |\n| Command installation | File copy via HM | Symlinks into repo | HM manages files; no dangling symlinks |\n| Protocol doc location | Stay in aura-scripts | Move to dotfiles | Protocol is reusable across users/projects |\n| Package wrapping | writeShellApplication | writeScriptBin | Proper runtime dep closure |\n| protocol.target | global/xdg enum | claude/opencode/both | Filesystem location, not tool targeting |\n| settings.json strategy | home.activation copy (Phase 4) | home.file symlink | Allows runtime writeback |\n| No lib export from flake | Keep internal | Export listMdFiles etc. | YAGNI — export when needed |\n| Schema evolution | Noted as future concern | Version tracking now | Premature until config formats stabilize |","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-82l","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"open","target":"","timeout_ns":0,"title":"PROPOSE_PLAN: REVISION-2 — aura-scripts Nix flake with HM modules","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"e761383f30d57fa9918431f474c7924c9a18a56fe3700750941979813e1bdb34","created_at":"2026-02-18T14:07:44Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"REQUEST was incorrectly renamed to EPIC in the Beads system. Epics are just a task type within Beads (like task, bug, feature), not a replacement for the REQUEST concept. The REQUEST type should be restored as its own distinct concept, and epic should remain only as a --type value for bd create.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-981","is_template":0,"issue_type":"bug","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"open","target":"","timeout_ns":0,"title":"Revert REQUEST→EPIC renaming: epics are a task type, not a replacement for REQUEST","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"architect","await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"cc11af21a782b3cd52440715371a7522329b760eb6aed49ca36326f76eb5acd9","created_at":"2026-02-20T03:03:38Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"## User Requirements Document — Aura Protocol v2\n\nSource: ELICIT aura-scripts-4ed | REQUEST aura-scripts-82j\n\n---\n\n### MVP v1 Scope (user directive: \"thinner MVP v1\")\n\nThe following are MVP. Strict validation/auditing deferred to v2.\n\n---\n\n## R1: Label Taxonomy\n**Format:** `aura:p{phase-number}-{phase}:s{step-number}-{type}`\n**Example:** `aura:p2-user:s2-elicit`, `aura:p3-plan:s1-propose`\n**Enforcement (MVP):** Auto-applied in skill templates. Validated post-creation.\n**Enforcement (v2):** Python plugin with XML schema for hard-block validation.\n\n## R2: Expanded Phase 1\nPhase 1 expands from a single REQUEST step to three sub-steps:\n- **s1_1-classify**: Classify request along 4 axes (scope, complexity, risk, domain novelty). Inspired by Finesse planner (github.com/jonathanung/finesse).\n- **s1_2-research**: Find domain standards, prior art, well-regarded projects. Depth configurable per-request based on classify output. Local always allowed; web for deeper needs. User confirms depth. See protocol/RESEARCH_EXAMPLE-nix-openclaw-req-ure-proposal.md. Inspired by get-shit-done (github.com/gsd-build/get-shit-done/).\n- **s1_3-explore**: Codebase exploration. Runs IN PARALLEL with s1_2-research.\n\n## R3: URD Merged into Phase 2\nURD creation is step s2_2 within Phase 2 (after s2_1-elicit survey). The URD is the single source of truth for requirements. Linked to all phases via `bd dep relate` (peer reference, not blocked-by). Updated via `bd comments add` as requirements evolve.\n\n## R4: Dependency Tree \u0026 Naming\n- **Title format:** Prefix with N — `PROPOSAL-1: ...`, `PROPOSAL-1-REVIEW-2: ...`\n- **Superseded proposals:** Both `aura:superseded` label AND comment linking to successor.\n- **Dependency direction:** `bd dep add \u003cparent\u003e --blocked-by \u003cchild\u003e`. Parent stays open until child finishes. Work bottom-up, closure top-down.\n\n## R5: Review Severity Tree\nEach review round produces: `SLICE-{N}-REVIEW-{reviewer}-{round}`\nChildren grouped by severity:\n- `...-BLOCKER` (severity group) → blocker leaf tasks\n- `...-IMPORTANT` (severity group) → important leaf tasks\n- `...-MINOR` (severity group) → minor leaf tasks\nEmpty severity groups → closed immediately.\n**Dual-parent:** BLOCKER severity tracker is child of BOTH the review round AND the slice.\n**Direction:** Leaf tasks are always children (they block parents). Leaf tasks are never blocked by anything.\n\n## R6: Follow-up Epic\nPost-review, create EPIC_FOLLOWUP containing:\n- URD from parent epic (via relates_to)\n- Review tracking issues from original IMPL_PLAN\n- FOLLOWUP_URE → FOLLOWUP_URD → FOLLOWUP_PROPOSAL → FOLLOWUP_IMPL_PLAN\n- Follow-up slices adopt IMPORTANT/MINOR leaf tasks as new children (dual-parent: leaf blocks both severity group and followup slice)\n- Followup kind: Separate enum values (FOLLOWUP_URE, FOLLOWUP_SLICE, etc.). Simple single-parent epic relationship — no followup-of-followup enum needed.\n\n## R7: Database Design\n- `tasks` table: id, title, description, status (open|closed|superseded), kind (enum), severity (independent dimension, nullable), epic_ref, plus missing fields (assignee, round_number, etc.)\n- `blocked_by` table: many-to-many (parent_id, child_id). Enables dual-parent.\n- `relates_to` table: symmetric with canonical ordering (task_a_id \u003c task_b_id). For URD links.\n- `labels` table: task_id + label string.\n- `comments` table: append-only audit trail.\n\n## R8: Handoff Documents\n- **Scope:** All phase transitions (Architect→Supervisor, Supervisor→Worker, Supervisor→Reviewer, Worker→Reviewer, Reviewer→Followup).\n- **Storage:** `.git/.aura/handoff/{something}.md` — local, NOT pushed to remote unless user explicitly wants.\n- **Provenance:** Depends on transition type. Architect→Supervisor = full inline. Others = summary + bd IDs.\n- **Template:** Embedded in each skill.\n\n## R9: Validation Pipeline (v2)\n- Python script wrapper, Claude Code / OpenCode plugin.\n- Rules defined as XML schema.\n- Hard block on failure.\n- MVP: structural checks only (label/title format). v2: graph-aware rules.\n\n## R10: Process Guardrails\n- Validation built into phase transitions (not a separate periodic command).\n- Notification via `.git/.aura/audit/latest.md`.\n- v2: testing strategy for the protocol itself.\n\n## R11: Migration Path\nNeed migration path from current protocol to new schema without breaking in-progress work. Deferred to detailed proposal.\n\n---\n\n## Design Decisions Log\n(Updated via bd comments add as UAT/review feedback arrives)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-9d9","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"open","target":"","timeout_ns":0,"title":"URD: Aura protocol v2 architectural redesign","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"architect","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T10:14:47Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"52f72c8766f96d42d9acc2516d69ce777217b9cdd73ea5e091b90ce311b501a4","created_at":"2026-02-20T03:05:05Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"## Requirements Traceability\n- **URD:** aura-scripts-9d9\n- **ELICIT:** aura-scripts-4ed\n- **REQUEST:** aura-scripts-82j\n\n## Problem Space\n\n**Axes:**\n- Parallelism: HIGH — skill files are independent, can be updated in parallel\n- Distribution: Single repo (aura-scripts), all files in commands/ and protocol/\n- Scale: ~25 files (20 skills + 5 protocol docs)\n- Frequency: One-time migration, then maintained per-epoch\n\n**Has-a / Is-a:**\n- EPIC HAS-A dependency tree (REQUEST → URE → PROPOSAL → IMPL_PLAN → slices)\n- REVIEW_ROUND HAS-A severity groups (BLOCKER, IMPORTANT, MINOR)\n- SEVERITY_GROUP HAS-A leaf tasks (dual-parent: also child of slice or followup-slice)\n- EPIC_FOLLOWUP IS-A EPIC (same phase structure, different kind enum)\n- URD IS-A Beads task (peer-linked via relates_to, not blocked-by)\n\n## Engineering Tradeoffs\n\n| Option | Pros | Cons | Decision |\n|--------|------|------|----------|\n| Full validation pipeline (v2) | Hard-block enforcement, XML schema | High implementation cost, blocks MVP | **Deferred** |\n| Skills-only update (v1) | Fast, low-risk, immediately usable | Relies on agent self-enforcement | **Selected** |\n| Database implementation | Enables graph queries | Beads is the DB; no custom DB needed | **Deferred** |\n| Handoff as repo files | Git-tracked, PR-reviewable | File bloat in main repo | Rejected — use .git/.aura/handoff/ |\n\n## MVP v1 Scope\n\nProtocol and skill file updates ONLY. No runtime tooling, no validation scripts, no DB changes.\n\n### In scope:\n1. **Label taxonomy** — Update all skills to use `aura:p{N}-{phase}:s{M}-{type}` format\n2. **Expanded Phase 1** — Add s1_1-classify, s1_2-research, s1_3-explore sub-steps\n3. **URD in Phase 2** — Merge URD creation into elicit skill as s2_2\n4. **Task naming** — Standardize PROPOSAL-N, REVIEW-M title prefixes\n5. **Review severity tree** — Document BLOCKER/IMPORTANT/MINOR structure in reviewer skills\n6. **Follow-up epic** — Add EPIC_FOLLOWUP workflow to epoch and supervisor skills\n7. **Handoff template** — Add template to each transition skill, storage at .git/.aura/handoff/\n8. **Superseded marking** — Add aura:superseded label + comment convention\n9. **Migration notes** — Document how to transition existing beads tasks\n\n### Out of scope (v2):\n- Python validation plugin / XML schema enforcement\n- Graph-aware validation rules\n- Automated audit/sweep commands\n- Testing strategy for the protocol itself\n- Database table implementation (beads IS the task store)\n\n## Public Interfaces\n\n### Label Schema (human convention, not code)\n\\`\\`\\`\naura:p{phase}-{domain}:s{step}-{type}\n\nPhases:\n  p1-user    — Phase 1: Request + classify + research + explore\n  p2-user    — Phase 2: Elicit + URD\n  p3-plan    — Phase 3: Propose\n  p4-plan    — Phase 4: Review\n  p5-user    — Phase 5: Plan UAT\n  p6-plan    — Phase 6: Ratify\n  p7-plan    — Phase 7: Handoff\n  p8-impl    — Phase 8: Impl plan\n  p9-impl    — Phase 9: Worker slices\n  p10-impl   — Phase 10: Code review\n  p11-user   — Phase 11: Impl UAT\n  p12-impl   — Phase 12: Landing\n\nSpecial labels:\n  aura:urd              — User Requirements Document\n  aura:superseded       — Superseded proposal/plan\n  aura:severity:blocker — Blocker severity group\n  aura:severity:important — Important severity group\n  aura:severity:minor   — Minor severity group\n\\`\\`\\`\n\n### Task Title Convention\n\\`\\`\\`\nREQUEST: {feature}\nELICIT: {feature}\nURD: {feature}\nPROPOSAL-{N}: {feature}\nPROPOSAL-{N}-REVIEW-{M}: Plan review\nUAT-{M}: Plan acceptance for {feature}\nIMPL_PLAN: {feature}\nSLICE-{N}: {slice description}\nSLICE-{N}-REVIEW-{reviewer}-{round}: Code review\nSLICE-{N}-REVIEW-{reviewer}-{round}-BLOCKER: Blocker findings\nSLICE-{N}-REVIEW-{reviewer}-{round}-IMPORTANT: Important findings\nSLICE-{N}-REVIEW-{reviewer}-{round}-MINOR: Minor findings\nEPIC_FOLLOWUP: {feature} follow-up\nFOLLOWUP_URE: {feature} follow-up requirements\nFOLLOWUP_URD: {feature} follow-up requirements document\nFOLLOWUP_PROPOSAL: {feature} follow-up proposal\nFOLLOWUP_IMPL_PLAN: {feature} follow-up implementation\nFOLLOWUP_SLICE-{N}: {slice description}\n\\`\\`\\`\n\n### Canonical Dependency Tree\n\\`\\`\\`\nREQUEST\n  └── blocked by ELICIT (URE survey)\n        └── blocked by PROPOSAL-1 (superseded)\n        │     └── blocked by PROPOSAL-1-REVIEW-1\n        │     └── blocked by PROPOSAL-1-REVIEW-2\n        │     └── blocked by PROPOSAL-1-REVIEW-3\n        └── blocked by PROPOSAL-N (ratified)\n              └── blocked by PROPOSAL-N-REVIEW-1\n              └── blocked by PROPOSAL-N-REVIEW-2\n              └── blocked by PROPOSAL-N-REVIEW-3\n              └── blocked by UAT-PLAN\n              └── blocked by IMPL_PLAN\n                    ├── blocked by SLICE-1\n                    │     ├── blocked by leaf-task-a\n                    │     ├── blocked by leaf-task-b\n                    │     └── blocked by SLICE-1-REVIEW-A-1-BLOCKER\n                    │           ├── blocked by blocker-leaf-1\n                    │           └── blocked by blocker-leaf-2\n                    └── blocked by SLICE-2\n                          └── ...\n\nURD ←──── bd dep relate ────→ (REQUEST, ELICIT, PROPOSAL, IMPL_PLAN, UAT)\n\nSLICE-1-REVIEW-A-1 (review round)\n  ├── blocked by SLICE-1-REVIEW-A-1-BLOCKER\n  │     └── blocked by blocker-leaf-1 (dual-parent: also blocks SLICE-1)\n  ├── blocked by SLICE-1-REVIEW-A-1-IMPORTANT\n  │     └── blocked by important-leaf-1 (dual-parent: also blocks FOLLOWUP-SLICE)\n  └── blocked by SLICE-1-REVIEW-A-1-MINOR\n        └── blocked by minor-leaf-1 (dual-parent: also blocks FOLLOWUP-SLICE)\n\nEPIC_FOLLOWUP\n  ├── relates_to URD (from parent epic)\n  └── blocked by FOLLOWUP_URE\n        └── blocked by FOLLOWUP_URD\n              └── blocked by FOLLOWUP_PROPOSAL\n                    └── blocked by FOLLOWUP_IMPL_PLAN\n                          ├── blocked by FOLLOWUP-SLICE-1\n                          │     ├── blocked by important-leaf-1 (from original review)\n                          │     └── blocked by minor-leaf-3 (from original review)\n                          └── blocked by FOLLOWUP-SLICE-2\n                                └── ...\n\\`\\`\\`\n\n### Handoff Document Location\n\\`\\`\\`\n.git/.aura/handoff/\n  {epic-id}/\n    {source-phase}-to-{target-phase}.md\n\\`\\`\\`\n\nExample: .git/.aura/handoff/aura-scripts-82j/architect-to-supervisor.md\n\n### Expanded Phase 1 Sub-steps\n\\`\\`\\`\nPhase 1: User Request\n  s1_1-classify:  Classify along 4 axes (scope, complexity, risk, domain novelty)\n  s1_2-research:  Domain research (local always, web configurable). PARALLEL.\n  s1_3-explore:   Codebase exploration. PARALLEL with s1_2.\n\\`\\`\\`\n\n## Types \u0026 Enums\n\n### Task Kind (informational, shapes beads task conventions)\n\\`\\`\\`\nREQUEST, ELICIT, URD, PROPOSAL, REVIEW_ROUND, REVIEW,\nIMPL_PLAN, SLICE, SEVERITY_GROUP, LEAF_TASK, UAT, RATIFIED_PLAN,\nEPIC_FOLLOWUP, FOLLOWUP_URE, FOLLOWUP_URD,\nFOLLOWUP_PROPOSAL, FOLLOWUP_IMPL_PLAN, FOLLOWUP_SLICE\n\\`\\`\\`\n\n### Severity (independent dimension, nullable)\n\\`\\`\\`\nBLOCKER | IMPORTANT | MINOR\n\\`\\`\\`\n\n### Classification Axes (Phase 1 s1_1)\n\\`\\`\\`\nScope:     single-file | multi-file | cross-cutting | new-subsystem\nComplexity: trivial | moderate | complex | research-required\nRisk:      low | medium | high | critical\nNovelty:   known-pattern | adaptation | novel | research-first\n\\`\\`\\`\n\n## Validation Checklist\n\n### Slice 1: Protocol core + label schema\n- [ ] protocol/CLAUDE.md updated with new label format and review severity tree\n- [ ] protocol/PROCESS.md updated with expanded Phase 1, review severity, follow-up epic\n- [ ] protocol/CONSTRAINTS.md updated with label schema and naming conventions\n\n### Slice 2: Phase 1-2 skills (request, elicit, epoch)\n- [ ] aura:epoch.md reflects expanded Phase 1 and follow-up epic\n- [ ] aura:user:request.md includes s1_1-classify, s1_2-research, s1_3-explore\n- [ ] aura:user:elicit.md merges URD creation as s2_2\n- [ ] Labels use aura:p{N}-{phase}:s{M}-{type} format\n\n### Slice 3: Phase 3-6 skills (architect, reviewer, ratify)\n- [ ] aura:architect.md references new label schema\n- [ ] aura:architect:propose-plan.md uses PROPOSAL-N naming\n- [ ] aura:architect:request-review.md spawns reviewers with severity tree instructions\n- [ ] aura:architect:ratify.md marks superseded proposals\n- [ ] aura:reviewer.md and review-plan.md produce severity-grouped findings\n- [ ] Handoff template embedded in aura:architect:handoff.md\n\n### Slice 4: Phase 7-11 skills (supervisor, worker, impl review, UAT)\n- [ ] aura:supervisor.md creates severity groups during review\n- [ ] aura:supervisor:plan-tasks.md references follow-up epic workflow\n- [ ] aura:impl:review.md produces SLICE-N-REVIEW-{reviewer}-{round} structure\n- [ ] aura:user:uat.md updated with new labels\n- [ ] Handoff templates in supervisor and impl:review skills\n\n### Cross-cutting\n- [ ] All bd dep add use --blocked-by (no positional format)\n- [ ] All skills reference URD via bd dep relate\n- [ ] Handoff template present in every phase-transition skill\n- [ ] Migration notes document in protocol/\n\n## BDD Acceptance Criteria\n\n**Given** an agent runs /aura:epoch\n**When** it reaches Phase 1\n**Then** it performs classify (s1_1), research (s1_2 parallel), explore (s1_3 parallel)\n**Should Not** skip classification or proceed without user confirmation of research depth\n\n**Given** a review round completes\n**When** findings are recorded\n**Then** each finding is a leaf task under a severity group (BLOCKER/IMPORTANT/MINOR) under a review round\n**Should Not** create flat review findings without severity grouping\n\n**Given** BLOCKER findings exist for a slice\n**When** the slice attempts to close\n**Then** the BLOCKER severity group must be resolved first (all blocker leaf tasks closed)\n**Should Not** close a slice with unresolved BLOCKER findings\n\n**Given** IMPORTANT/MINOR findings remain after BLOCKER resolution\n**When** the original epic closes\n**Then** an EPIC_FOLLOWUP is created with those findings as children of followup slices\n**Should Not** lose IMPORTANT/MINOR findings when the original epic closes\n\n**Given** a phase transition occurs\n**When** handing off to the next phase\n**Then** a handoff document is written to .git/.aura/handoff/{epic-id}/\n**Should Not** transition without creating the handoff document\n\n**Given** a proposal is superseded\n**When** PROPOSAL-N+1 is created\n**Then** PROPOSAL-N gets aura:superseded label AND a comment linking to N+1\n**Should Not** leave the old proposal unmarked\n\n## Files Affected\n\n### Protocol core (modify)\n- protocol/CLAUDE.md\n- protocol/PROCESS.md\n- protocol/CONSTRAINTS.md\n\n### Phase 1-2 skills (modify)\n- commands/aura:epoch.md\n- commands/aura:user:request.md\n- commands/aura:user:elicit.md\n\n### Phase 3-6 skills (modify)\n- commands/aura:plan.md\n- commands/aura:architect.md\n- commands/aura:architect:propose-plan.md\n- commands/aura:architect:request-review.md\n- commands/aura:architect:ratify.md\n- commands/aura:architect:handoff.md\n\n### Phase 7-11 skills (modify)\n- commands/aura:supervisor.md\n- commands/aura:supervisor:plan-tasks.md\n- commands/aura:supervisor:track-progress.md\n- commands/aura:impl:review.md\n- commands/aura:impl:slice.md\n- commands/aura:user:uat.md\n\n### Review skills (modify)\n- commands/aura:reviewer.md\n- commands/aura:reviewer:review-plan.md\n- commands/aura:reviewer:review-code.md\n\n### Protocol templates (modify)\n- protocol/UAT_TEMPLATE.md\n\n### New files (create)\n- protocol/HANDOFF_TEMPLATE.md\n- protocol/MIGRATION_v1_to_v2.md","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-9hn","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"PROPOSAL-1: Aura protocol v2 — MVP skill \u0026 process updates","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":"2026-02-20T23:01:59Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"c6edcef3e92d465d4b5a31eeb56c45720428270e32ffb291a567419912b71694","created_at":"2026-02-20T23:00:48Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-9z5","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"PROPOSAL-2-REVIEW-A-2: Correctness review","updated_at":"2026-02-20T23:01:59Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T10:14:46Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"fd70d443a404780fc144f20350fb2779d493aad3998f047a6b0bf1a3af0a3137","created_at":"2026-02-20T03:13:44Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"Vote: ACCEPT\n\nIMPORTANT:\n1. protocol/user-request-revamp-v2.md disposition unaddressed — stale artifact after migration\n2. UAT_TEMPLATE.md still uses ACCEPT_WITH_COMMENTS in decision field — needs vocabulary reconciliation\n\nMINOR:\n3. BDD missing \"no IMPORTANT/MINOR remain\" happy path (no followup needed)\n4. Migration label mapping omits Phase 12 (landing) — is it new or existing?\n5. Handoff storage split between request-id and followup-id dirs — document in template","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-aua","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"PROPOSAL-2-REVIEW-A-1: Plan review (Reviewer A: Correctness)","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"ea4ea2acf42335d48ee9ae55e10e7f5fde10b470dc2e5e815797211723f83ab3","created_at":"2026-02-20T23:09:23Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"---\nreferences:\n  request: aura-2o8\n  urd: aura-635\n  proposal: aura-6j5\n---\nHandoff from architect to supervisor. See handoff document at\n.git/.aura/handoff/aura-2o8/architect-to-supervisor.md","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-ay1","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"open","target":"","timeout_ns":0,"title":"HANDOFF: Architect → Supervisor for REQUEST aura-2o8","updated_at":"2026-02-20T23:09:23Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"worker-slice-3","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T08:56:21Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"e5929619b2b5309ae44c15dd0241ce96ddc717f1dbffe4bfe6d587994722d7fe","created_at":"2026-02-20T08:15:14Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"## References\n- IMPL_PLAN: aura-scripts-xky\n- PROPOSAL-2: aura-scripts-5eh\n- URD: aura-scripts-9d9\n\n## Blocked by SLICE-1 (protocol core must be done first)\n\n## Files (12)\n- commands/aura:plan.md (MODERATE)\n- commands/aura:architect.md (FULL)\n- commands/aura:architect:propose-plan.md (MODERATE)\n- commands/aura:architect:request-review.md (MODERATE)\n- commands/aura:architect:ratify.md (MODERATE)\n- commands/aura:architect:handoff.md (FULL — handoff template)\n- commands/aura:reviewer.md (FULL — severity tree + vocabulary)\n- commands/aura:reviewer:review-plan.md (MODERATE)\n- commands/aura:reviewer:review-code.md (FULL — severity tree procedure)\n- commands/aura:reviewer:comment.md (FULL — vocabulary reconciliation)\n- commands/aura:reviewer:vote.md (MODERATE)\n- commands/aura:feedback.md (FULL — vocabulary reconciliation or deprecation)\n\n## Key Changes\n1. PROPOSAL-N / REVIEW-M naming in architect skills\n2. Superseded marking (aura:superseded + comment)\n3. Full severity tree procedure in review-code.md: EAGER creation, dual-parent bd dep add\n4. ACCEPT/REVISE vocabulary everywhere\n5. BLOCKER/IMPORTANT/MINOR replacing BLOCKING/MAJOR/MINOR\n6. Plan review = ACCEPT/REVISE only (no severity tree)\n7. Code review = full severity tree\n8. Handoff template in architect:handoff.md\n9. Remove RFC content from review-code.md and comment.md\n10. Replace bd dep relate with frontmatter references\n\n## Quality Gates\n- grep these 12 files for old labels → 0 hits\n- grep for BLOCKING, MAJOR, APPROVE_WITH_COMMENTS, REQUEST_CHANGES, REJECT → 0 hits\n- grep for bd dep relate → 0 hits\n- grep for positional bd dep add → 0 hits\n- grep for rfc, RFC → 0 hits in review-code.md and comment.md","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-bqu","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"SLICE-3: Phase 3-7 skills (architect + reviewer)","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":"2026-02-20T13:17:21Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"7eba059d4d1a4da8e6d2ddcfbf0c586599b40d8e365238709df33407240c8dbf","created_at":"2026-02-20T13:17:17Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"Implementation UAT for IMPL_PLAN epic aura-scripts-xky (Aura protocol v2 — MVP skill \u0026 process updates).\n\n6 UAT Components presented, all ACCEPTED:\n\nComponent 1 (Label Schema): ACCEPT\nComponent 2 (Phase Flow): ACCEPT\nComponent 3 (Review Axes): ACCEPT\nComponent 4 (Severity Tree): ACCEPT\nComponent 5 (Handoff Documents): ACCEPT\nComponent 6 (Follow-up Lifecycle): Initially REVISE — user wanted full FOLLOWUP_* lifecycle with h6 handoff. Fixed via 3 parallel workers (~45 gaps across ~30 files). Re-presented and ACCEPTED.\n  - User note on recursion: 'Recursion can be allowed: would create a FOLLOWUP_URE-2 and FOLLOWUP_URD-2, FOLLOWUP_PROPOSAL-2-1...'\n\nPost-UAT audit (user-initiated):\n- Phase 1 substep audit: 4 Haiku explorers found 8 gaps. User designated 6 as BLOCKERs (fixed): expanded s1_2/s1_3 procedures, added schema enums, added Phase 1 output refs to elicit/propose-plan, created deferred v2 tracking task (aura-scripts-w0d).\n- Gaps 3 (Finesse ref) and 4 (GSD ref) deferred to follow-up (aura-scripts-ci6).\n- User requested dedicated /aura:research and /aura:explore skills extracted as general-purpose commands. Created both + updated SKILLS.md and AGENTS.md.\n\nParent tasks: REQUEST aura-scripts-82j, URD aura-scripts-9d9, IMPL_PLAN aura-scripts-xky","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-cgv","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"UAT: Impl UAT Phase 11 — aura-scripts-xky","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"UAT passed, all 5 components ACCEPTED. Plan ratified.","closed_at":"2026-02-18T14:55:50Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"aac4142b53ea615c1a0687fdbdf747b2589874ac8685641ee85eb29e4af916e8","created_at":"2026-02-18T14:47:51Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"## Components Reviewed\n\n### Component 1: Module Structure\n**Definition shown:**\n```nix\nCUSTOM.programs.aura-config-sync = {\n  enable = true;\n  packages.enable = true;\n  commands.enable = true;\n  agents.enable = true;\n  protocol.enable = false;\n};\n```\n**Motivating example:** Minimal setup enabling only commands (packages/agents disabled).\n\n**Q1: The module uses CUSTOM.programs.aura-config-sync as the namespace. This matches your dotfiles convention (CUSTOM.programs.*). The alternative would be programs.aura-config-sync (standard HM namespace) or services.aura-config-sync. Which namespace is correct?**\nOptions:\n- CUSTOM.programs (current) — Matches your dotfiles convention for custom HM modules — keeps it separate from upstream programs.*\n- programs.aura-config-sync — Standard HM namespace — discoverable but risks collision with future upstream modules\n- aura.config-sync — Custom top-level namespace — clearly non-standard, no collision risk\n**User response:** \"The CUSTOM namespace is for the modules defined in the @~/dotfiles repo. Since this is external, should go into aura.config-sync\"\n\n**Q2: Protocol docs default to enable = false because installing to ~/.claude/CLAUDE.md would overwrite any personal CLAUDE.md you have there. The alternative is default true with a merge strategy. Is default-off the right call?**\nOptions:\n- Default off (current) — User must opt-in. Safest — never overwrites personal CLAUDE.md. But easy to forget to enable.\n- Default on, xdg target — Default to ~/.config/aura/protocol/ instead of ~/.claude/ — always installs but never conflicts with personal CLAUDE.md\n- Default on, global target — Installs to ~/.claude/ — convenient but WILL overwrite personal CLAUDE.md on every home-manager switch\n**User response:** \"Default on, xdg target\"\n\n**Decision:** ACCEPT\n\n---\n\n### Component 2: Commands with Role Filtering\n**Definition shown:**\n```nix\naura.config-sync.commands = {\n  enable = true;\n  roles = { enableAll = true; architect.enable = ...; supervisor.enable = ...; worker.enable = ...; reviewer.enable = ...; epoch.enable = ...; };\n  extraCommands = { \"my-custom:command.md\" = ./my-command.md; };\n};\n```\n**Motivating example:** Worker-only machine with enableAll=false, worker.enable=true.\n\n**Q1: Currently epoch is classified as a role alongside architect/supervisor/worker/reviewer. But epoch orchestrates ALL roles — setting enableAll=false would hide it, which breaks orchestration. Should epoch be reclassified?**\nCore commands (always installed): aura:plan, aura:status, aura:test, aura:feedback, aura:msg:*, aura:impl:*, aura:user:*\nRole commands (togglable): aura:architect:*, aura:supervisor:*, aura:worker:*, aura:reviewer:*\nOptions:\n- Move epoch to core commands — Always installed regardless of enableAll. Epoch orchestrates all roles so it should always be available.\n- Keep epoch as a role — A machine running only workers doesn't need epoch. User can explicitly enable epoch alongside their chosen roles.\n- Separate orchestration tier — Three tiers: core (always), orchestration (epoch), roles (architect/supervisor/worker/reviewer). Adds complexity but models the hierarchy accurately.\n**User response:** \"Move epoch to core commands\"\n\n**Q2: The extraCommands extension point uses attrsOf path — keys are filenames, values are file paths. This means you can add project-specific commands. Is this the right extension mechanism, or should it support inline text too?**\nOptions:\n- Path only (current) — Simple — just point to .md files. Consistent with how all other commands work.\n- Path or text — attrsOf (either path or str) — allows inline command definitions in Nix config. More flexible but mixed types add complexity.\n- Path only + extraCommandDirs — Add a second option to include entire directories of commands. Useful if you have many project-specific commands.\n**User response:** \"Path only + extraCommandDirs\"\n\n**Q3 (user-initiated comment, verbatim):** \"installation should rely mostly on creating mkOutOfStoreSymlink paths, similar to some other existing configs in ~/dotfiles that require more responsiveness and live updating, and don't require an entire build/recompilation step.\"\n\n**Decision:** ACCEPT with comments (mkOutOfStoreSymlink)\n\n---\n\n### Component 3: Package Wrapping\n**Definition shown:**\n```nix\n# Current (broken): writeScriptBin with shebang replace only\n# Proposed: writeShellApplication with runtimeInputs = [ python3 tmux git ]\n```\n**Motivating example:** launch-parallel fails at runtime because tmux not in PATH.\n\n**Q1: launch-parallel.py needs tmux and git at runtime. aura-swarm needs git, bd (beads CLI), and claude. Should ALL runtime deps be baked into the Nix wrapper, or should some be expected from the user's PATH?**\nOptions:\n- Bake all in (hermetic) — writeShellApplication with all runtimeInputs. launch-parallel gets python3+tmux+git. aura-swarm gets python3+git+bd+claude. Fully reproducible.\n- Bake tmux+python, expect claude+bd from PATH — claude and bd are user-managed tools (not in nixpkgs or custom). Wrap what Nix can provide, leave the rest to PATH.\n- Expect all from PATH — Only patch the shebang. User is responsible for having tmux, git, claude, bd available. Lightest wrapper.\n**User response:** \"Bake all in (hermetic)\"\n\n**Decision:** ACCEPT\n\n---\n\n### Component 4: settings.json Writeback Strategy (Phase 4)\n**Definition shown:** Three options: A) activation copy, B) base+overlay merge, C) nix-only read-only\n**Motivating example:** Claude Code writes permissions to settings.json at runtime; home.file symlinks are read-only.\n\n**Q1: Claude Code writes to ~/.claude/settings.json at runtime (e.g., when you grant permissions). Nix home.file creates read-only symlinks. How should Phase 4 handle this conflict?**\nOptions:\n- Activation copy (Option A) — Nix generates file, copies on switch. Runtime edits persist between switches but get overwritten on next rebuild. Simplest to implement.\n- Base + overlay (Option B) — Nix writes settings.base.json (immutable), runtime writes to settings.local.json, merged at startup. Never loses runtime changes. But requires custom merge logic and Claude Code doesn't support split configs.\n- Nix-only, no runtime writes (Option C) — All settings managed in Nix. home.file symlink, read-only. If Claude Code tries to write, it fails. You manage ALL permissions/settings in your Nix config.\n- Defer to Phase 4 — Don't decide now. Phase 4 design will have more context about what Claude Code actually needs at runtime. Just note it as an open question.\n**User response:** \"Defer to Phase 4\" with note: \"Can do Option B with some custom script for merging a user's config with the into the final\"\n\n**Decision:** ACCEPT\n\n---\n\n### Component 5: mkOutOfStoreSymlink for Live Updates\n**Definition shown:**\n```nix\n# Store symlink (current): source = \"${self}/commands/file.md\" → /nix/store/...\n# Out-of-store (proposed): source = config.lib.file.mkOutOfStoreSymlink \"/home/.../aura-scripts/commands/file.md\"\n```\n**Motivating example:** Edits to command files in repo immediately visible without home-manager switch.\n\n**Q1: mkOutOfStoreSymlink needs the absolute path to the aura-scripts repo checkout. How should this be configured?**\nOptions:\n- Explicit repoPath option (required) — User sets the path in their config. Clear, no magic. Fails with assertion if not set.\n- Explicit repoPath with default — Default to a conventional path like ~/codebases/dayvidpham/aura-scripts. User can override. Convenient but assumes directory structure.\n- Detect from flake input — Use self.outPath or builtins.toString self to derive the path. Works when flake is a local path input, not when fetched from GitHub.\n**User response:** \"Explicit repoPath option (required)\"\n\n**Q2: Should ALL file types use mkOutOfStoreSymlink (commands, agents, protocol docs), or only some?**\nOptions:\n- All files use mkOutOfStoreSymlink — Commands, agents, and protocol docs all live-update. Consistent behavior. All require repoPath.\n- Commands + agents live, protocol via store — Commands/agents change often during development. Protocol docs are more stable — store path is fine.\n- Make it configurable per section — Add a liveUpdate = true/false toggle per section. Maximum flexibility, more options to manage.\n**User response:** \"All files use mkOutOfStoreSymlink\"\n\n**User comment (verbatim):** \"Wondering how this will work with cross-config compilation. Should we adopt a yaml file based approach, some base json schema, or Nix-native? I think the agentconfig repo adopts a yaml file based approach?\"\n\n**Decision:** ACCEPT with comments\n\n---\n\n## Final Decision\n**ACCEPT** — All 5 components accepted. Key design changes from REVISION-2:\n1. Namespace: aura.config-sync (not CUSTOM.programs)\n2. Protocol: default on, xdg target\n3. Epoch: core command, not a role\n4. Extra commands: path + extraCommandDirs\n5. Installation: mkOutOfStoreSymlink with required repoPath\n6. Package wrapping: hermetic (all deps baked in)\n7. settings.json: deferred to Phase 4, Option B likely direction\n8. Open question: cross-config compilation strategy (yaml/json/nix-native) for Phase 4","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-ci4","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"UAT-1: Plan acceptance for aura-scripts Nix flake REVISION-2","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"17d1c0e3cf2962cb982ed5c50b9a31f1e4a1d25801238cb871d6962942f580eb","created_at":"2026-02-20T13:16:57Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"Two deferred gaps from impl UAT Phase 11 audit:\n\nGap 3 (IMPORTANT): Finesse planner reference — URD mentions a 'Finesse planner' concept that should be referenced in planning phase docs (architect:propose-plan, supervisor:plan-tasks). Currently not mentioned anywhere in protocol.\n\nGap 4 (IMPORTANT): get-shit-done (GSD) reference — URD mentions a GSD research depth/mode. Should inform the research skill's quick-scan depth level and be documented as an alias or shortcut mode.\n\nSource: Phase 11 UAT audit of Phase 1 substep implementation (4 Haiku explorers).","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-ci6","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"open","target":"","timeout_ns":0,"title":"FOLLOWUP: Capture Finesse planner + GSD references in protocol","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T10:22:51Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"c445809483dfd2506597451f2309ea48d8bfeade8cf7748dbf8f638caa02b143","created_at":"2026-02-20T10:13:42Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"---\nreferences:\n  impl_plan: aura-scripts-xky\n  urd: aura-scripts-9d9\n  proposal: aura-scripts-5eh\n  request: aura-scripts-82j\n---\n## Axis B: Test quality\n\nReview all 40 changed files for quality of examples and testability patterns.\n\nKey questions:\n- Do code examples show correct Go test patterns (testing package, _test.go conventions)?\n- Are anti-patterns clearly marked and correct patterns clearly shown?\n- Do L2 test examples import actual production code (not mock implementations)?\n- Are DI patterns correct (mock deps, not SUT)?\n- Are validation checklists complete and actionable?\n- Do BDD acceptance criteria use Given/When/Then/Should format correctly?\n\n## Files to Review\n40 files: git diff --name-only main...HEAD\n\n## Vote\nBinary: ACCEPT or REVISE","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-du8","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"IMPL-REVIEW-B-1: Code review (Reviewer B: Test quality)","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-18T14:07:49Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"690c806b1d329331b53ae61fb847934ff386aaaf2cba8b60c57d8ac4d0471bf1","created_at":"2026-02-18T13:56:15Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-eiq","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"REVIEW_1: Plan review for aura-scripts Nix flake","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"5b794181f1b41a5e83c137b4b097fa7b7082d6f550a455e0d80963c3132f7bab","created_at":"2026-02-18T07:42:08Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"VERBATIM USER REQUEST:\n\nShould look into @~/codebases/agentconfig to create a single source of truth for our ~/.claude/commands, hooks, configs, and settings/permissions. The burden is increasing to try and get a single common config for both Claude Code and OpenCode; a more recent version of some commands and CLAUDE.md files exist at @~/codebases/dayvidpham/aura-scripts/protocol/ .\n\n---\n\nCONTEXT:\n- ~/codebases/agentconfig is an existing TypeScript project (has package.json, tsconfig, src/, test/)\n- ~/.claude/commands/ contains aura slash commands\n- ~/codebases/dayvidpham/aura-scripts/protocol/ has newer versions of CLAUDE.md, CONSTRAINTS.md, PROCESS.md\n- User wants unified config management across Claude Code and OpenCode\n- Current pain: maintaining duplicate/divergent configs across tools","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-ght","is_template":0,"issue_type":"feature","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"open","target":"","timeout_ns":0,"title":"EPIC: Unified agent config — aura-scripts as Nix flake with HM modules","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T10:22:51Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"6cd108d6da768f298005aa010859161014257fcb8babfb11e5e129640cb824f0","created_at":"2026-02-20T10:13:37Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"---\nreferences:\n  impl_plan: aura-scripts-xky\n  urd: aura-scripts-9d9\n  proposal: aura-scripts-5eh\n  request: aura-scripts-82j\n---\n## Axis A: Correctness (spirit and technicality)\n\nReview all 40 changed files against the ratified plan and URD.\n\nKey questions:\n- Do the docs accurately describe the v2 12-phase protocol?\n- Are all labels consistent with the schema aura:p{N}-{domain}:s{M}-{type}?\n- Are examples correct (Go code, correct bd commands, correct dependency direction)?\n- Are reviewer naming conventions (PROPOSAL-N-REVIEW-{axis}-{round}) consistent everywhere?\n- Do handoff procedures match the HANDOFF_TEMPLATE?\n- Are frontmatter references used correctly (not bd dep relate)?\n\n## Files to Review\n40 files: git diff --name-only main...HEAD\n\n## Vote\nBinary: ACCEPT or REVISE","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-hl2","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"IMPL-REVIEW-A-1: Code review (Reviewer A: Correctness)","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"adeededf04ce175fed8d8425427ab8cbb2e9a0d729bf2c28d862415d6043c873","created_at":"2026-02-20T22:54:47Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"---\nreferences:\n  request: aura-2o8\n  urd: aura-635\n---\n## Problem Space\n\n**Axes:**\n- Parallelism: Low — hooks are sequential (SessionStart before agent starts, PreToolUse before each skill)\n- Distribution: Local — all within one Claude Code session\n- Frequency: aura-prime runs 1-2x/session; aura-context runs once per skill invocation (~5-20x/session)\n- Has-a: schema.xml HAS context-defaults, HAS transition hints; hooks HAVE schema parser\n- Is-a: aura-prime IS a content injector; aura-context IS a context router\n\n## Architecture\n\n### Two hooks, two lifecycles\n\n```\n┌─────────────────────────────────────────────────────┐\n│ SessionStart / PreCompact                           │\n│   aura_prime.py → reads CLAUDE.md → stdout (text)   │\n│   Result: agent has full protocol directive          │\n└─────────────────────────────────────────────────────┘\n\n┌─────────────────────────────────────────────────────┐\n│ PreToolUse (matcher: \"Skill\")                       │\n│   aura_context.py → reads schema.xml → parses       │\n│     → maps skill → role, phase → context-defaults    │\n│     → gets available skills + transition hints       │\n│     → stdout JSON { systemMessage: \"...\" }           │\n│   Result: agent knows what docs to read + next steps │\n└─────────────────────────────────────────────────────┘\n```\n\n### Schema extension: context-defaults + transition hints\n\n```xml\n\u003c!-- NEW: Role-level doc defaults --\u003e\n\u003ccontext-defaults\u003e\n  \u003crole-context role-ref=\"epoch\"\u003e\n    \u003cdoc-ref ref=\"doc-process\"/\u003e\n    \u003cdoc-ref ref=\"doc-constraints\"/\u003e\n  \u003c/role-context\u003e\n  \u003crole-context role-ref=\"architect\"\u003e\n    \u003cdoc-ref ref=\"doc-process\"/\u003e\n    \u003cdoc-ref ref=\"doc-constraints\"/\u003e\n  \u003c/role-context\u003e\n  \u003crole-context role-ref=\"supervisor\"\u003e\n    \u003cdoc-ref ref=\"doc-process\"/\u003e\n    \u003cdoc-ref ref=\"doc-constraints\"/\u003e\n  \u003c/role-context\u003e\n  \u003crole-context role-ref=\"reviewer\"\u003e\n    \u003cdoc-ref ref=\"doc-process\"/\u003e\n    \u003cdoc-ref ref=\"doc-constraints\"/\u003e\n  \u003c/role-context\u003e\n  \u003crole-context role-ref=\"worker\"\u003e\n    \u003cdoc-ref ref=\"doc-constraints\"/\u003e\n    \u003c!-- No PROCESS.md for workers per user requirement --\u003e\n  \u003c/role-context\u003e\n\u003c/context-defaults\u003e\n\n\u003c!-- NEW: Phase-level doc overrides (additive) --\u003e\n\u003ccontext-overrides\u003e\n  \u003cphase-override role-ref=\"architect\" phase-ref=\"p7\"\u003e\n    \u003cdoc-ref ref=\"doc-handoff\"/\u003e\n  \u003c/phase-override\u003e\n  \u003cphase-override role-ref=\"supervisor\" phase-ref=\"p10\"\u003e\n    \u003cdoc-ref ref=\"doc-handoff\"/\u003e\n  \u003c/phase-override\u003e\n\u003c/context-overrides\u003e\n\n\u003c!-- EXTENDED: Transition hints --\u003e\n\u003ctransition to-phase=\"p5\" condition=\"all 3 reviewers vote ACCEPT\"\u003e\n  \u003chint\u003eAll reviewers ACCEPT → run /aura:user:uat for Phase 5 Plan UAT\u003c/hint\u003e\n\u003c/transition\u003e\n```\n\n### File structure\n\n```\naura-plugins/\n├── .claude-plugin/\n│   └── plugin.json           # Extended with hooks section\n├── hooks/\n│   ├── aura_prime.py         # SessionStart + PreCompact\n│   └── aura_context.py       # PreToolUse for Skill tool\n├── skills/\n│   └── protocol/\n│       └── schema.xml        # Extended with context-defaults + hints\n└── ...\n```\n\n## Interfaces\n\n### aura_prime.py output (raw text to stdout)\n```\n# Aura Protocol - Agent Directive\n[full content of skills/protocol/CLAUDE.md]\n```\n\n### aura_context.py output (JSON to stdout)\n```json\n{\n  \"systemMessage\": \"## Aura Context: aura:supervisor:plan-tasks\\nRole: supervisor | Phase: p8 (Impl Plan) | Domain: impl\\n\\n### Required Reading\\n- skills/protocol/PROCESS.md#phase-8 — Workflow for this phase\\n- skills/protocol/CONSTRAINTS.md — Coding standards\\n\\n### Available Skills (Phase p8, Role supervisor)\\n- /aura:supervisor:plan-tasks — Decompose into vertical slices\\n- /aura:supervisor:spawn-worker — Launch a worker agent\\n\\n### Next Steps\\n- All slices created → proceed to Phase 9\"\n}\n```\n\n### plugin.json hooks section\n```json\n{\n  \"hooks\": {\n    \"SessionStart\": [{\n      \"matcher\": \"\",\n      \"hooks\": [{\n        \"type\": \"command\",\n        \"command\": \"python3 ${CLAUDE_PLUGIN_ROOT}/hooks/aura_prime.py\"\n      }]\n    }],\n    \"PreCompact\": [{\n      \"matcher\": \"\",\n      \"hooks\": [{\n        \"type\": \"command\",\n        \"command\": \"python3 ${CLAUDE_PLUGIN_ROOT}/hooks/aura_prime.py\"\n      }]\n    }],\n    \"PreToolUse\": [{\n      \"matcher\": \"Skill\",\n      \"hooks\": [{\n        \"type\": \"command\",\n        \"command\": \"python3 ${CLAUDE_PLUGIN_ROOT}/hooks/aura_context.py\",\n        \"timeout\": 10\n      }]\n    }]\n  }\n}\n```\n\n## Tradeoffs\n\n| Decision | Chosen | Alternative | Rationale |\n|----------|--------|-------------|-----------|\n| Hook output format | Raw text (prime) / JSON (context) | All JSON | Follows bd-prime pattern for SessionStart; JSON required for PreToolUse systemMessage |\n| Schema location for hints | In \u003ctransition\u003e elements | Separate hints section | Co-locates hints with their conditions; no duplication |\n| Context-defaults granularity | Role-level + phase overrides | Per-command | 5 role entries + few overrides vs 36 command entries; user preference |\n| XML parser | xml.etree.ElementTree (stdlib) | lxml | No external dependency; fast enough for 1237-line schema |\n| SKILL.md cleanup | Strip duplicated G/W/T only | Strip all references | Preserves See Also navigation; minimal churn |\n\n## MVP Scope\n\n**In MVP:**\n1. schema.xml extension (context-defaults + transition hints for all 12 phases)\n2. aura_prime.py hook (SessionStart + PreCompact)\n3. aura_context.py hook (PreToolUse on Skill)\n4. plugin.json hooks configuration\n5. Tests for schema parsing and context building\n\n**Phase 2 (follow-up):**\n- SKILL.md cleanup (strip duplicated content from 38 files)\n- Validation that stripped content matches what hooks inject\n- Performance benchmarking of schema parsing\n\n## Validation Checklist\n- [ ] schema.xml has context-defaults section with all 5 roles\n- [ ] schema.xml has context-overrides section with phase-specific additions\n- [ ] schema.xml transitions have hint children for all conditional transitions\n- [ ] aura_prime.py outputs full CLAUDE.md content on stdout\n- [ ] aura_context.py parses schema.xml and outputs correct doc pointers\n- [ ] aura_context.py outputs available skills for current role+phase\n- [ ] aura_context.py outputs transition hints for current phase\n- [ ] plugin.json has all 3 hook entries (SessionStart, PreCompact, PreToolUse)\n- [ ] Hook exits 0 on all error paths (never blocks operations)\n- [ ] Tests pass for schema parsing\n- [ ] Type checking passes\n\n## BDD Acceptance Criteria\n\nGiven SessionStart event\nWhen aura_prime.py executes\nThen stdout contains full CLAUDE.md content\nShould never output empty or partial content\n\nGiven PreCompact event\nWhen aura_prime.py executes\nThen stdout contains full CLAUDE.md content (same as SessionStart)\nShould never fail silently\n\nGiven Skill tool invocation with skill=\"aura:supervisor:plan-tasks\"\nWhen aura_context.py receives stdin JSON\nThen stdout JSON systemMessage contains:\n  - Doc pointers for supervisor role (PROCESS.md + CONSTRAINTS.md)\n  - Available skills at phase p8\n  - Transition hints for phase p8\nShould never contain docs for wrong role\n\nGiven Skill tool invocation with skill=\"aura:worker:implement\"\nWhen aura_context.py receives stdin JSON\nThen stdout JSON systemMessage contains:\n  - Doc pointers for worker role (CONSTRAINTS.md only, NO PROCESS.md)\n  - Available skills at phase p9\nShould never include PROCESS.md for worker role\n\nGiven schema.xml with context-defaults and phase-override for architect at p7\nWhen aura_context.py processes skill=\"aura:architect:handoff\"\nThen stdout includes HANDOFF_TEMPLATE.md pointer in addition to role defaults\nShould never replace role defaults with override (additive)\n\nGiven malformed stdin JSON\nWhen aura_context.py tries to parse\nThen exits 0 (allow operation)\nShould never exit non-zero or block the skill invocation\n\nGiven unknown skill name not in schema.xml\nWhen aura_context.py looks up context\nThen outputs empty systemMessage or skips injection\nShould never crash or block","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-id1","is_template":0,"issue_type":"feature","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"open","target":"","timeout_ns":0,"title":"PROPOSAL-1: Schema-driven context hooks for aura-plugins","updated_at":"2026-02-20T22:54:47Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T10:22:52Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"1c547055a97b37a88055965bc0a65c8f8464f0a840989beec6075e37468d38bb","created_at":"2026-02-20T10:13:59Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"Minor findings from Reviewer B (Test quality)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-k87","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"IMPL-REVIEW-B-1 MINOR","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T10:22:51Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"a1d2cffddce57f481a8b57afb640893623c78985f629bd42ff8b4f3c63538862","created_at":"2026-02-20T10:13:59Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"Blocker findings from Reviewer B (Test quality)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-ky7","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"IMPL-REVIEW-B-1 BLOCKER","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T10:22:51Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"6277fe817394ed2ab6ed4e64776902b6f9735fbe8454dca6e5f71ef0b9e243a8","created_at":"2026-02-20T10:14:00Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"Blocker findings from Reviewer C (Elegance)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-ldb","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"IMPL-REVIEW-C-1 BLOCKER","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-18T14:09:11Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"67d610a3819e9db85bf0a4f153a9a547493f54ecc43c23997202d4a30fa708d1","created_at":"2026-02-18T13:56:15Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-m1w","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"REVIEW_3: Plan review for aura-scripts Nix flake","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T10:22:52Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"c5121728a62361106b59663cd9874f10b0db9b98beb462b32161c826eeed50eb","created_at":"2026-02-20T10:14:00Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"Minor findings from Reviewer C (Elegance)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-m20","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"IMPL-REVIEW-C-1 MINOR","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"9f4e87125f68b4512473ce93e9face2545edf4652547b28a4e7e0a20ea079491","created_at":"2026-02-20T23:09:24Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"---\nreferences:\n  request: aura-2o8\n  urd: aura-635\n  proposal: aura-6j5\n---\n## Vertical Slice Decomposition\n\n### Execution Order\n- SLICE-1 (schema) and SLICE-2 (aura-prime) run in PARALLEL (no deps between them)\n- SLICE-3 (aura-context) depends on SLICE-1 (needs context-defaults + hints in schema.xml)\n\n### SLICE-1: Schema Extension\nFiles: skills/protocol/schema.xml\n- L1: Define XML structure for context-defaults, context-overrides, transition hints\n- L2: Schema validation test (parse and verify structure)\n- L3: Write all context-defaults (5 roles), context-overrides (phase additions), and descriptive hints for all conditional transitions\n\n### SLICE-2: aura-prime Hook\nFiles: hooks/aura_prime.py, .claude-plugin/plugin.json, tests/test_aura_prime.py, tests/fixtures/claude_md_stub.md\n- L1: Define input/output contract (no stdin, raw text stdout)\n- L2: Integration test (subprocess invocation, verify CLAUDE.md in stdout)\n- L3: Implement hook + plugin.json SessionStart/PreCompact entries\n\n### SLICE-3: aura-context Hook\nFiles: hooks/aura_context.py, tests/test_aura_context.py, tests/fixtures/schema_minimal.xml\n- L1: Define input/output contract (stdin JSON, stdout JSON systemMessage)\n- L2: Integration test (subprocess with stdin, verify JSON output with doc pointers + skills + hints)\n- L3: Implement hook + plugin.json PreToolUse entry + utility skill default\n\n### Dependencies\nSLICE-1 ──┐\n           ├── SLICE-3 (blocked by SLICE-1)\nSLICE-2 ──┘ (independent)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-n1w","is_template":0,"issue_type":"epic","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"open","target":"","timeout_ns":0,"title":"IMPL_PLAN: Schema-driven context hooks","updated_at":"2026-02-20T23:09:59Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T10:14:46Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"4b7717964a522759941cc0b5a90935f8b3b5ecd03eb0a6d7dd2984f2820128a9","created_at":"2026-02-20T03:13:44Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"Vote: ACCEPT\n\nBoth Round 1 BLOCKERs RESOLVED:\n- B1: All 33 skill files now listed with change depths\n- B2: Dual-parent BLOCKER fully operationalized with bd dep add sequences\n\nMINOR:\n1. File count says 40 but enumeration sums to 39 (off-by-one)\n2. Example protocol files (HANDOFF_EXAMPLE-*, RESEARCH_EXAMPLE-*, UAT_EXAMPLE.md) not mentioned\n3. Migration table missing new-only labels (aura:epic-followup, aura:severity:*)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-n58","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"PROPOSAL-2-REVIEW-B-1: Plan review (Reviewer B: Test quality)","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"worker-slice-5","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T08:54:11Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"13e45eae92ec091a5d065f2b06b6ade38c96cdc91b21ca4126cff38fcc3a69c6","created_at":"2026-02-20T08:15:14Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"## References\n- IMPL_PLAN: aura-scripts-xky\n- PROPOSAL-2: aura-scripts-5eh\n- URD: aura-scripts-9d9\n\n## Blocked by SLICE-1 (protocol core must be done first)\n\n## Files (6)\n- commands/aura:status.md (MODERATE — many label references)\n- commands/aura:test.md (MINIMAL)\n- commands/aura:msg:send.md (MINIMAL)\n- commands/aura:msg:broadcast.md (MINIMAL)\n- commands/aura:msg:receive.md (MINIMAL)\n- commands/aura:msg:ack.md (MINIMAL)\n\n## Key Changes\n1. aura:status.md: update all label references to new format\n2. Messaging skills: update examples to new naming conventions\n3. aura:test.md: minimal label references\n4. Replace any bd dep relate with frontmatter references\n\n## Quality Gates\n- grep these 6 files for old labels → 0 hits\n- grep for bd dep relate → 0 hits","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-rzf","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"SLICE-5: Utility + messaging skills","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T10:22:52Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"3837087a663c04a111a44f6b0b5883fe2b88af549ea3591d829f5e29a7fd23b2","created_at":"2026-02-20T10:13:59Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"Important findings from Reviewer B (Test quality)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-t0n","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"IMPL-REVIEW-B-1 IMPORTANT","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"worker-slice-2","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T08:56:20Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"19f4cb25960efadc45a0490ac2769a5715de5fffdc211b908d05c897c919ae7f","created_at":"2026-02-20T08:15:14Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"## References\n- IMPL_PLAN: aura-scripts-xky\n- PROPOSAL-2: aura-scripts-5eh\n- URD: aura-scripts-9d9\n\n## Blocked by SLICE-1 (protocol core must be done first)\n\n## Files (3)\n- commands/aura:epoch.md (FULL)\n- commands/aura:user:request.md (FULL)\n- commands/aura:user:elicit.md (FULL)\n\n## Key Changes\n1. aura:epoch.md: 12-phase with new labels, expanded Phase 1, follow-up epic, eager severity tree\n2. aura:user:request.md: s1_1-classify, s1_2-research (parallel), s1_3-explore (parallel)\n3. aura:user:elicit.md: URD creation as s2_2, new labels\n4. Replace bd dep relate with frontmatter references\n5. All bd dep add use --blocked-by\n\n## Quality Gates\n- grep these 3 files for old labels → 0 hits\n- grep for bd dep relate → 0 hits\n- grep for positional bd dep add → 0 hits","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-tbp","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"SLICE-2: Phase 1-2 skills","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":"2026-02-20T23:01:34Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"b57e735b973fd9faa95302407382217e102c56ba549fdd3ac13560d7558c51f5","created_at":"2026-02-20T23:00:44Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-uga","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"PROPOSAL-2-REVIEW-C-2: Elegance review","updated_at":"2026-02-20T23:01:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"4310799fcdff541e97af07d2c8ed49e058b2439efd56aa4d342a67c8bdfd8b61","created_at":"2026-02-20T12:56:07Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"---\nreferences:\n  request: aura-scripts-82j\n  urd: aura-scripts-9d9\n---\n## Deferred URD Requirements (MVP v1 → v2)\n\nThese requirements were explicitly deferred from MVP v1 scope per user directive ('thinner MVP v1').\n\n### R9: Validation Pipeline (v2)\n- Python script wrapper, Claude Code / OpenCode plugin\n- Rules defined as XML schema\n- Hard block on failure\n- MVP delivered structural checks only (label/title format in protocol docs)\n- v2: automated enforcement via plugin\n\n### R10 v2: Process Guardrails (graph-aware)\n- MVP: validation built into phase transitions (documented in protocol)\n- v2: graph-aware rules (query task relationships, not just structural fields)\n- v2: testing strategy for the protocol itself\n- Notification via .git/.aura/audit/latest.md\n\n### R11: Migration Path\n- Migration path from v1 to v2 labels for in-progress work\n- MIGRATION_v1_to_v2.md exists as documentation\n- v2: automated migration tooling\n\n## Source\nURD aura-scripts-9d9 sections R9, R10, R11\nUser directive: 'lots of requirements gathered at this point. Strict validations and auditting can be for a v2. Need a thinner MVP v1.'","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-w0d","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"open","target":"","timeout_ns":0,"title":"DEFERRED-V2: Validation pipeline, graph-aware rules, migration path","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T10:14:49Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"59a5ed07589138945b8969ecd31bdb736e7499cd76f39c87ecbf69b2c039aa06","created_at":"2026-02-20T07:37:38Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"## Components Reviewed\n\n### Component 1a: Label Taxonomy\n**Definition shown:** aura:p{N}-{domain}:s{M}-{type} format with before/after examples\n**Question:** Does this label design match your intent from the URE?\n**Options:** ACCEPT / REVISE\n**User response:** ACCEPT\n\n### Component 1b: Review Severity Tree\n**Definition shown:** Lazy creation with dual-parent BLOCKER, single-parent IMPORTANT/MINOR\n**Question:** Does this severity tree structure match your intent?\n**Options:** ACCEPT / REVISE\n**User response (verbatim):** \"REVISE: should not have lazy creation. Should have eager creation of severity groups and no findings at that level just means a severity group with no children\"\n\n### Component 1c: Follow-up Epic\n**Definition shown:** Supervisor creates after Phase 10 once all BLOCKERs resolved\n**Question:** Does this trigger and ownership match your intent?\n**Options:** ACCEPT / REVISE\n**User response (verbatim):** \"REVISE: the follow-up epic trigger should be upon completion of the the review step, by the supervisor, if any IMPORTANT/MINOR findings exist at all NOT only when BLOCKERS are resolved.\"\n\n### Component 2a: Handoff Documents\n**Definition shown:** 5 actor-change transitions, .git/.aura/handoff/ storage, provenance depth by type\n**Question:** Does this handoff scope and storage match your intent?\n**Options:** ACCEPT / REVISE\n**User response:** ACCEPT\n\n### Component 2b: Migration\n**Definition shown:** Additive (old labels kept, old titles recognized, no retroactive restructuring)\n**Question:** Does this migration approach work for you?\n**Options:** ACCEPT / REVISE\n**User response:** ACCEPT\n\n### Component 2c: Vocabulary Reconciliation\n**Definition shown:** 4-level votes → binary ACCEPT/REVISE, BLOCKING/MAJOR → BLOCKER/IMPORTANT\n**Question:** Does this vocabulary reconciliation match your intent?\n**Options:** ACCEPT / REVISE\n**User response:** ACCEPT\n\n## Final Decision\nACCEPT with two revisions:\n1. Severity groups: EAGER creation (always 3 groups per review round)\n2. Follow-up epic: created upon review completion if ANY IMPORTANT/MINOR exist","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-w8w","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"UAT-1: Plan acceptance for Aura protocol v2","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"36c912965a9f58bbc50841f871a1a546be265d14032a013b36fa11446668c966","created_at":"2026-02-20T23:08:30Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"---\nreferences:\n  request: aura-2o8\n  urd: aura-635\n  proposal: aura-6j5\n---\n## Plan UAT Results\n\n### Component 1: Utility Skill Handling\n**Definition shown:** aura-context hook resolves skill → command → role → phase from schema.xml. Some skills have no role-ref (aura:status, aura:test, aura:msg:*).\n\n**Q1: Should the hook skip context injection for utility skills (no role, no phase-specific docs), or inject a minimal default?**\n\n**Options presented:**\n- **Skip injection** — Utility skills get no context injection from the hook. They have their own SKILL.md instructions. Simplest approach.\n- **Minimal default** — Utility skills get CONSTRAINTS.md pointer only. Ensures every skill invocation has at least coding standards context.\n- **Configurable in schema** — Add a \u003cutility-context\u003e element in context-defaults that applies to commands with no role-ref. Most flexible but adds schema complexity.\n\n**User response (verbatim):** \"Minimal default: Get CONSTRAINTS.md and CLAUDE.md\"\n\n**Decision:** ACCEPT — Utility skills get both CONSTRAINTS.md and CLAUDE.md pointers as minimal default.\n\n---\n\n### Component 2: Transition Hint Style\n**Definition shown:** schema.xml transitions currently have no hints. Adding \u003chint\u003e children to all conditional transitions is part of MVP.\n\n**Q1: Should hints be terse (one-line, just the skill) or descriptive (condition summary + skill + outcome)?**\n\n**Options presented:**\n- **Terse** — Just the actionable instruction: 'Run /aura:user:uat' or 'Create PROPOSAL-{N+1} via /aura:architect:propose-plan'\n  ```xml\n  \u003ctransition to-phase=\"p5\" condition=\"all 3 reviewers vote ACCEPT\"\u003e\n    \u003chint\u003eRun /aura:user:uat\u003c/hint\u003e\n  \u003c/transition\u003e\n  \u003ctransition to-phase=\"p3\" condition=\"any reviewer votes REVISE\"\u003e\n    \u003chint\u003eCreate PROPOSAL-{N+1} via /aura:architect:propose-plan\u003c/hint\u003e\n  \u003c/transition\u003e\n  ```\n- **Descriptive** — Include condition context + skill + outcome: 'All 3 reviewers ACCEPT → run /aura:user:uat to present plan to user for Phase 5 approval'\n  ```xml\n  \u003ctransition to-phase=\"p5\" condition=\"all 3 reviewers vote ACCEPT\"\u003e\n    \u003chint\u003eAll reviewers ACCEPT → run /aura:user:uat to present plan to user for Phase 5 approval\u003c/hint\u003e\n  \u003c/transition\u003e\n  \u003ctransition to-phase=\"p3\" condition=\"any reviewer votes REVISE\"\u003e\n    \u003chint\u003eREVISE vote found → create PROPOSAL-{N+1} via /aura:architect:propose-plan, mark current proposal aura:superseded\u003c/hint\u003e\n  \u003c/transition\u003e\n  ```\n\n**User response (verbatim):** \"Descriptive\" — selected the descriptive option with the full XML preview.\n\n**Decision:** ACCEPT — Hints are descriptive with condition + skill + outcome.\n\n---\n\n## Final Decision\n**ACCEPT** — Both components accepted. Refinements from UAT:\n1. Utility skills get minimal default (CONSTRAINTS.md + CLAUDE.md pointers)\n2. Transition hints are descriptive (condition summary + skill + what happens next)","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-xdt","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"open","target":"","timeout_ns":0,"title":"UAT-1: Plan acceptance for context hooks PROPOSAL-2","updated_at":"2026-02-20T23:08:30Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":"supervisor","await_id":"","await_type":"","close_reason":"Closed","closed_at":"2026-02-20T09:01:50Z","closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"275443d88fc64dbedceb18ee62b878414be48e56af3ca3aeb07fb740118e33c2","created_at":"2026-02-20T08:14:39Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"## References\n- URD: aura-scripts-9d9\n- PROPOSAL-2 (ratified): aura-scripts-5eh\n- REQUEST: aura-scripts-82j\n- ELICIT: aura-scripts-4ed\n- UAT-1: aura-scripts-w8w\n\n## UAT Revisions to Incorporate\n1. Severity groups: EAGER creation (always 3 groups per review round, empty = no children)\n2. Follow-up epic: created by Supervisor upon review completion if ANY IMPORTANT/MINOR exist (NOT gated on BLOCKER resolution)\n\n## Constraint Change\n- DO NOT use bd dep relate — it is buggy\n- For \"related\" references (URD, etc.), include task IDs in description frontmatter\n\n## Implementation Strategy\n\n40 files across 5 slices. Slice 1 is prerequisite for Slices 2-5.\nSlices 2-5 can run in parallel after Slice 1 completes.\n\nAll changes are protocol/documentation updates (markdown skill files). No runtime code.\n\n## Slice 1: Protocol Core + Label Schema (PREREQUISITE)\nFiles (6): protocol/CLAUDE.md, protocol/PROCESS.md, protocol/CONSTRAINTS.md, protocol/UAT_TEMPLATE.md, protocol/HANDOFF_TEMPLATE.md (CREATE), protocol/MIGRATION_v1_to_v2.md (CREATE)\nChange depth: FULL\n\nKey changes:\n- New label format aura:p{N}-{domain}:s{M}-{type} throughout\n- Review severity tree with EAGER creation + dual-parent BLOCKER\n- Follow-up epic workflow (trigger: review completion + IMPORTANT/MINOR exist)\n- Vocabulary reconciliation (ACCEPT/REVISE, BLOCKER/IMPORTANT/MINOR)\n- Replace all bd dep relate references with frontmatter references\n- Dependency direction examples (bd dep add \u003cparent\u003e --blocked-by \u003cchild\u003e)\n- Handoff template (CREATE)\n- Migration procedure with label + title mapping tables (CREATE)\n- Expanded Phase 1 (classify, research, explore)\n\nValidation: grep protocol/ for old labels, old vocabulary, bd dep relate\n\n## Slice 2: Phase 1-2 Skills (3 files)\nFiles: aura:epoch.md, aura:user:request.md, aura:user:elicit.md\nChange depth: FULL\n\nKey changes:\n- aura:epoch.md: 12-phase with new labels, expanded Phase 1, follow-up epic, severity tree\n- aura:user:request.md: s1_1-classify, s1_2-research, s1_3-explore sub-steps\n- aura:user:elicit.md: URD creation as s2_2, new labels\n- Replace bd dep relate with frontmatter references\n\nValidation: grep for old labels, old dep format\n\n## Slice 3: Phase 3-7 Skills — Architect + Reviewer (12 files)\nFiles: aura:plan.md, aura:architect.md, aura:architect:propose-plan.md, aura:architect:request-review.md, aura:architect:ratify.md, aura:architect:handoff.md, aura:reviewer.md, aura:reviewer:review-plan.md, aura:reviewer:review-code.md, aura:reviewer:comment.md, aura:reviewer:vote.md, aura:feedback.md\nChange depth: FULL for architect.md, handoff.md, reviewer.md, review-code.md, comment.md, feedback.md; MODERATE for rest\n\nKey changes:\n- PROPOSAL-N / REVIEW-M naming in all architect skills\n- Superseded marking (aura:superseded label + comment)\n- Full severity tree procedure in review-code.md (eager creation, dual-parent bd commands)\n- ACCEPT/REVISE vocabulary in reviewer.md, vote.md, comment.md, feedback.md\n- BLOCKER/IMPORTANT/MINOR replacing BLOCKING/MAJOR/MINOR\n- Plan review = ACCEPT/REVISE only (no severity tree)\n- Code review = full severity tree\n- Handoff template in architect:handoff.md\n- Remove RFC content from review-code.md and comment.md\n- Replace bd dep relate with frontmatter references\n\nValidation: grep for old labels, old vocabulary, BLOCKING, MAJOR, APPROVE, REQUEST_CHANGES, REJECT, bd dep relate\n\n## Slice 4: Phase 8-12 Skills — Supervisor + Worker + Impl (12 files)\nFiles: aura:supervisor.md, aura:supervisor:plan-tasks.md, aura:supervisor:track-progress.md, aura:supervisor:spawn-worker.md, aura:supervisor:commit.md, aura:impl:review.md, aura:impl:slice.md, aura:worker.md, aura:worker:implement.md, aura:worker:complete.md, aura:worker:blocked.md, aura:user:uat.md\nChange depth: FULL for supervisor.md, impl:review.md; MODERATE for rest; MINIMAL for commit.md, blocked.md\n\nKey changes:\n- Supervisor owns EPIC_FOLLOWUP creation (trigger: review completion + IMPORTANT/MINOR exist)\n- impl:review.md: severity tree procedure, SLICE-N-REVIEW naming, handoff\n- Handoff templates in spawn-worker.md (Supervisor→Worker) and worker:complete.md (Worker→Reviewer)\n- SLICE-N naming in plan-tasks.md\n- New labels throughout\n- Replace bd dep relate with frontmatter references\n\nValidation: grep for old labels, old dep format, bd dep relate\n\n## Slice 5: Utility + Messaging Skills (6 files)\nFiles: aura:status.md, aura:test.md, aura:msg:send.md, aura:msg:broadcast.md, aura:msg:receive.md, aura:msg:ack.md\nChange depth: MODERATE for status.md; MINIMAL for rest\n\nKey changes:\n- aura:status.md: update all label references (aura:propose-plan → aura:p3-plan:s1-propose, etc.)\n- Messaging skills: update examples to new naming conventions\n- aura:test.md: minimal label references if any\n- Replace any bd dep relate with frontmatter references\n\nValidation: grep for old labels\n\n## Quality Gates (per slice)\n1. grep for old-format labels (aura:plan:propose, aura:impl, etc.) — must return 0\n2. grep for old vocabulary (BLOCKING, MAJOR, APPROVE_WITH_COMMENTS, REQUEST_CHANGES, REJECT) — must return 0\n3. grep for bd dep relate — must return 0\n4. grep for positional bd dep add (without --blocked-by) — must return 0\n5. Verify all bd dep add examples use correct direction","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-xky","is_template":0,"issue_type":"epic","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"closed","target":"","timeout_ns":0,"title":"IMPL_PLAN: Aura protocol v2 — MVP skill \u0026 process updates","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"e941e59ab65dbc1d3b36d871bc90686092bf954a874e72dfb7c324cb7632cdd9","created_at":"2026-02-20T22:52:53Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"---\nreferences:\n  request: aura-2o8\n---\n## URE Survey Results\n\n### Q1: Injection mode (how to deliver context)\n**Question:** Should the hook inject actual file content, just pointers, or hybrid?\n**Options:**\n- Pointer mode: systemMessage with file paths and anchors. Lower tokens, requires Read calls.\n- Content injection: Full doc content in systemMessage. No extra reads, high token cost.\n- Hybrid: Inject CLAUDE.md always, pointers for PROCESS.md/CONSTRAINTS.md.\n**User answer:** Hybrid. \"Should only inject CLAUDE.md on startup and post-compaction. Similar to bd-prime hook from Beads.\"\n\n### Q2: Migration strategy (what to change in SKILL.md files)\n**Question:** Strip all doc references, leave them, or strip only duplicated content?\n**Options:**\n- Strip and centralize: Remove all references from SKILL.md, hook is SSOT.\n- Additive only: Leave existing, hook adds missing.\n- Strip duplicated content only: Remove inline G/W/T constraints that are already in CONSTRAINTS.md, keep See Also links.\n**User answer:** Strip duplicated content only.\n\n### Q3: aura-prime output level\n**Question:** Full CLAUDE.md always, adaptive, or condensed?\n**Options:**\n- Full CLAUDE.md always (~400 lines, ~6k tokens)\n- Adaptive (shorter if schema available, longer if not)\n- Condensed always (~1-2k tokens)\n**User answer:** Full CLAUDE.md always.\n\n### Q4: Schema design for doc injection\n**Question:** Per-command context-docs, role-phase matrix, or role-level defaults + overrides?\n**Options:**\n- Per-command context-docs (36 commands to annotate)\n- Role-phase matrix (roles × phases entries)\n- Role-level defaults + overrides (5 role entries + overrides)\n**User answer:** Role-level defaults + optional phase overrides. \"Should be a role-level default + optional phase override.\"\n\n### Q5: Skill hints\n**Question:** Should the hook output available skills at current phase?\n**Options:**\n- Yes, include skill hints\n- No, skills only\n**User answer:** Yes, include skill hints. \"There should be a default hint, but for triggers/conditional handoffs, need to write a custom hint.\"\n\n### Q6: Custom hint storage\n**Question:** Where to define custom hints for conditional transitions?\n**Options:**\n- In schema.xml transitions (extend \u003ctransition\u003e with \u003chint\u003e)\n- Separate hints section in schema.xml\n- In SKILL.md files\n**User answer:** In schema.xml transitions. Extend existing \u003ctransition\u003e elements with \u003chint\u003e child.\n\n### Q7: Packaging\n**Question:** In aura-plugins repo or separate?\n**Options:**\n- In aura-plugins repo (hooks/ directory)\n- Separate repo/script\n**User answer:** In aura-plugins repo.","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-xw6","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"open","target":"","timeout_ns":0,"title":"ELICIT: Context fragment management — requirements elicitation","updated_at":"2026-02-20T22:52:53Z","waiters":"","wisp_type":"","work_type":"mutex"}
{"acceptance_criteria":"","actor":"","agent_state":"","assignee":null,"await_id":"","await_type":"","close_reason":"","closed_at":null,"closed_by_session":"","compacted_at":null,"compacted_at_commit":null,"compaction_level":0,"content_hash":"2e58a3e20a433353c0a5f3083697b0961753c48412ca7c4de778e1e285ddd5d3","created_at":"2026-02-18T13:49:47Z","created_by":"David Huu Pham","crystallizes":0,"defer_until":null,"description":"PHASE 2: USER REQUIREMENTS ELICITATION\n\n## Verbatim User Request (Phase 1)\n\n\"Should look into @~/codebases/agentconfig to create a single source of truth for our ~/.claude/commands, hooks, configs, and settings/permissions. The burden is increasing to try and get a single common config for both Claude Code and OpenCode; a more recent version of some commands and CLAUDE.md files exist at @~/codebases/dayvidpham/aura-scripts/protocol/ .\"\n\nAddendum: \"An immediate translation and integration point I want to set up soon is @~/codebases/dayvidpham/opencode-security\"\n\n## Questions \u0026 Answers (All Verbatim)\n\n### Q1: What is the primary artifact you want agentconfig to manage?\nOptions presented: Everything unified | Settings + commands only | Config translation layer\n**Answer: Everything unified** — agentconfig becomes single source for settings/permissions, slash commands, protocol docs, hooks, and security filter config.\n\n### Q2: For the OpenCode integration, what does the translation look like?\nOptions: Bidirectional sync | One canonical source | Just security for now\n**Answer: Bidirectional sync** — can read either tool config and translate to the other.\n\n### Q3: Where should protocol docs live canonically?\nOptions: Stay in aura-scripts | Move to agentconfig | Shared git submodule\n**Answer (verbatim):** \"For my purposes, turn aura-scripts into a set of consumable NixOS modules/home-manager modules. In that case, should stay in aura-scripts, or can go in @~/dotfiles\"\n\n### Q4: What is the deployment model?\nOptions: Symlinks | Build + install script | Nix/Home Manager\n**Answer (verbatim):** \"Nix/Home Manager. How complicated is agentconfig? Does it deal with versioned schemas for the various tools?\"\n(Answered: agentconfig has Zod schemas but no versioned schema migrations.)\n\n### Q5: Dotfiles repo — does it already use home-manager?\nOptions: Flake + home-manager | Flake no HM | Not Nix-based\n**Answer: Flake + home-manager** — already manages some configs declaratively.\n\n### Q6: Nix module architecture for aura-scripts?\nOptions: Flake with HM module | Overlay + packages | Monorepo in dotfiles\n**Answer (verbatim):** \"Should maybe be (1) and (2). Would want a good flake with options to support tweaking and customization. What would we even be overlaying? Flake should provide nixosModules and/or hmModules, have seen this pattern before.\"\n\n### Q7: Sync engine — bidirectional sync approach?\nOptions: Nix-generated static | agentconfig TypeScript | Hybrid\n**Answer (verbatim):** \"Should be (1) for now, but should actually be using Golang. (1) is required when binaries or scripts (aura-swarm or launch-parallel) change.\"\n\n### Q8: Priority order?\nOptions: Nix module | OpenCode security | Config translation | Unify commands\n**Answer:** \"(1) Nix module, then (3) Config translation, then (4) Unify commands, then (2) OpenCode security\"\n\n## Additional User Feedback (Post-Elicitation)\n\n### Role of agentconfig\n**Verbatim:** \"We want to use agentconfig as inspiration for our own project, not using it in its own right.\"\n\n### Module structure\nUser rejected 3 separate HM modules. Wants a **single module**: `homeManagerModules.aura-config-sync`\n\n### Role selection pattern\nUser wants individual enables with `enableAll` default, NOT a list of role strings:\n```nix\nroles = {\n  enableAll = mkOption { type = bool; default = true; };\n  architect.enable = mkOption { ... default = cfg.commands.roles.enableAll; };\n  # etc.\n};\n```\n\n### Review process\nUser stated: \"Dont skip formal review.\" Then: \"Shouldnt be using the launch-parallel script, should just launch them with TeamCreate.\"\n\n### Epic structure\nUser stated: \"This should be an epic, and should have been captured by a URD.\"\nUser stated: \"The URE should capture all of the users inputs and feedback. It must also keep all of the users Q\u0026A.\"","design":"","due_at":null,"ephemeral":0,"estimated_minutes":null,"event_kind":"","external_ref":null,"hook_bead":"","id":"aura-ztn","is_template":0,"issue_type":"task","last_activity":null,"metadata":"{}","mol_type":"","notes":"","original_size":null,"owner":"dayvidpham@gmail.com","payload":"","pinned":0,"priority":2,"quality_score":null,"rig":"","role_bead":"","role_type":"","sender":"","source_repo":".","source_system":"","spec_id":null,"status":"open","target":"","timeout_ns":0,"title":"URE: Unified agent config via Nix home-manager modules","updated_at":"2026-02-20T16:21:34Z","waiters":"","wisp_type":"","work_type":"mutex"}
